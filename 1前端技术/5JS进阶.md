<h1 class="article-title no-number">JSè¿›é˜¶</h1>

# ç±»

## ç±»çš„å®šä¹‰

**ç±»æ˜¯ç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¨¡æ¿ã€‚**

æ¯ä¸ªç±»ä¸­åŒ…å«äº†ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³• **constructor()**ï¼Œå®ƒæ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼Œè¿™ç§æ–¹æ³•ç”¨äºåˆ›å»ºå’Œåˆå§‹åŒ–ä¸€ä¸ªç”± **class** åˆ›å»ºçš„å¯¹è±¡ã€‚

```js
class Person {
  constructor(name, age) {
    this.name = name; // thisæŒ‡è¯¥ç±»çš„å®ä¾‹å¯¹è±¡
    this.age = age;
  }
  speak() {
    // speakæ–¹æ³•åœ¨ç±»çš„åŸå‹å¯¹è±¡ä¸Šï¼Œä¾›å®ä¾‹è°ƒç”¨ï¼Œ
    // é€šè¿‡Personå®ä¾‹è°ƒç”¨speakæ—¶ï¼Œspeakä¸­çš„thisæ˜¯Personå®ä¾‹
    // é€šè¿‡callã€bindç­‰æ–¹æ³•è°ƒç”¨speakï¼ŒthisæŒ‡å‘è¢«æ”¹å˜
    console.log(`My name is ${this.name}, I am ${this.age} years old.`);
  }
}
const p1 = new Person('Tom', 18);
p1.speak();
```

## ç±»çš„ç»§æ‰¿

JavaScript ç±»ç»§æ‰¿ä½¿ç”¨ extends å…³é”®å­—ï¼Œ`super()` æ–¹æ³•ç”¨äºè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚

```js
class Person {
  constructor(name, age) {
    this.name = name; // thisæŒ‡è¯¥ç±»çš„å®ä¾‹å¯¹è±¡
    this.age = age;
  }
  speak() {
    // speakæ–¹æ³•åœ¨ç±»çš„åŸå‹å¯¹è±¡ä¸Šï¼Œä¾›å®ä¾‹è°ƒç”¨
    // é€šè¿‡Personå®ä¾‹è°ƒç”¨speakæ—¶ï¼Œspeakä¸­çš„thisæ˜¯Personå®ä¾‹
    // é€šè¿‡callã€bindç­‰æ–¹æ³•è°ƒç”¨speakï¼ŒthisæŒ‡å‘è¢«æ”¹å˜
    console.log(`My name is ${this.name}, I am ${this.age} years old.`);
  }
}

class Student extends Person {
  constructor(name, age, school) {
    super(name, age); // è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
    this.school = school;
  }
  study() {
    // studyæ–¹æ³•åœ¨ç±»çš„åŸå‹å¯¹è±¡ä¸Šï¼Œä¾›å®ä¾‹è°ƒç”¨
    // é€šè¿‡Studentå®ä¾‹è°ƒç”¨studyæ—¶ï¼Œstudyä¸­çš„thisæ˜¯Studentå®ä¾‹
    console.log(`I study in ${this.school}.`);
  }
}

const stu1 = new Student('Tom', 18, 'ECNU');

stu1.speak(); // My name is Tom, I am 18 years old.
stu1.study(); // I study in ECNU school.
```

## æ€»ç»“

1. ç±»ä¸­çš„`constructor`ä¸æ˜¯å¿…é¡»ï¼Œè¦å¯¹å®ä¾‹æ·»åŠ ä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œå¦‚æ·»åŠ æŒ‡å®šå±æ€§æ—¶é‡‡ç”¨ã€‚
2. å¦‚æœ A ç±»ç»§æ‰¿äº† B ç±»ï¼Œä¸” A ç±»ä¸­äº›äº†æ„é€ å™¨ï¼Œé‚£ä¹ˆ A ç±»æ„é€ å™¨ä¸­ï¼Œå¿…é¡»è¦ç”¨`super()`è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ã€‚
3. ç±»ä¸­æ‰€å®šä¹‰çš„æ–¹æ³•ï¼Œéƒ½åœ¨ç±»çš„åŸå‹å¯¹è±¡ä¸Šï¼Œä¾›å®ä¾‹è°ƒç”¨ã€‚

# é¢å‘å¯¹è±¡ç¼–ç¨‹

**ä»€ä¹ˆæ˜¯å¯¹è±¡ï¼Ÿä¸‡ç‰©çš†å¯¹è±¡ã€‚**

**åœ¨ JavaScript ä¸­ï¼Œæ‰€æœ‰æ•°æ®ç±»å‹éƒ½å¯ä»¥è§†ä¸ºå¯¹è±¡ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å¯¹è±¡ã€‚ è‡ªå®šä¹‰çš„å¯¹è±¡æ•°æ®ç±»å‹å°±æ˜¯é¢å‘å¯¹è±¡ä¸­çš„ç±»ï¼ˆ Class ï¼‰çš„æ¦‚å¿µã€‚**

## é¢å‘è¿‡ç¨‹ & é¢å‘å¯¹è±¡

æˆ‘ä»¬ä»¥ä¸€ä¸ªç¤ºä¾‹æ¥è¯´æ˜ä¸¤è€…åŒºåˆ«ã€‚

æˆ‘ä»¬éœ€è¦å¤„ç†å­¦ç”Ÿæˆç»©ï¼Œå°†å­¦ç”Ÿçš„æˆç»©æ‰“å°å‡ºæ¥ã€‚

é¦–å…ˆï¼Œé¢å‘è¿‡ç¨‹ç¼–ç¨‹çš„æ–¹å¼æ˜¯è¿™æ ·çš„ã€‚

```js
// é¢å‘è¿‡ç¨‹ç¼–ç¨‹
// 1. å­˜å‚¨å­¦ç”Ÿæˆç»©ä¿¡æ¯
var std1 = { name: 'å¼ ä¸‰', score: 98 };
var std2 = { name: 'æå››', score: 81 };
// 2. è¾“å‡ºå­¦ç”Ÿæˆç»©
function printScore(student) {
  console.log('å§“åï¼š' + student.name + '  ' + 'æˆç»©ï¼š' + student.score);
}
```

é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œè€ƒè™‘çš„ä¸æ˜¯ç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œè€Œæ˜¯ Student è¿™ä¸ªå¯¹è±¡æœ‰å“ªäº›**å±æ€§**å’Œ**æ–¹æ³•**ã€‚

```js
// é¢å‘å¯¹è±¡ç¼–ç¨‹
// 1. å®šä¹‰å¯¹è±¡ï¼ˆç±»ï¼‰
function Student(name, score) {
  this.name = name;
  this.score = score;
}
Student.prototype.printScore = function () {
  console.log('å§“åï¼š' + this.name + '  ' + 'æˆç»©ï¼š' + this.score);
};
// 2. å®ä¾‹åŒ–å¯¹è±¡
var std1 = new Student('å¼ ä¸‰', 98);
var std2 = new Student('æå››', 81);
// 3. è¾“å‡ºå­¦ç”Ÿæˆç»©
std1.printScore(); // => å§“åï¼šå¼ ä¸‰  æˆç»©ï¼š98
std2.printScore(); // => å§“åï¼šæå››  æˆç»© 81
```

## å¦‚ä½•åˆ›å»ºå¯¹è±¡

#### å­—é¢é‡æ–¹å¼

æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ `new Object()` åˆ›å»ºã€‚

```js
var person = new Object();
person.name = 'å¼ ä¸‰';
person.age = 18;
person.sayName = function () {
  console.log(this.name);
};
```

æ¯æ¬¡åˆ›å»ºé€šè¿‡ `new Object()` æ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å®ƒçš„ç®€å†™å½¢å¼å¯¹è±¡å­—é¢é‡æ¥åˆ›å»ºã€‚

```js
var person = {
  name: 'å¼ ä¸‰',
  age: 18,
  sayName: function () {
    console.log(this.name);
  },
};
```

ä¸Šé¢çš„å†™æ³•æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯å‡å¦‚æˆ‘ä»¬è¦ç”Ÿæˆä¸¤ä¸ª `person` å®ä¾‹å¯¹è±¡å‘¢ï¼Ÿ

```js
var person1 = {
  name: 'å¼ ä¸‰',
  age: 18,
  sayName: function () {
    console.log(this.name);
  },
};
var person2 = {
  name: 'æå››',
  age: 16,
  sayName: function () {
    console.log(this.name);
  },
};
```

#### å·¥å‚æ¨¡å¼

```js
function createPerson(name, age) {
  return {
    name: name,
    age: age,
    sayName: function () {
      console.log(this.name);
    },
  };
}
var p1 = createPerson('å¼ ä¸‰', 18);
var p2 = createPerson('æå››', 18);
```

è¿™æ ·å°è£…æ¯”ä¸Šè¾¹çš„æ–¹å¼å¥½å¤šäº†ï¼Œé€šè¿‡å·¥å‚æ¨¡å¼æˆ‘ä»¬è§£å†³äº†åˆ›å»ºå¤šä¸ªç›¸ä¼¼å¯¹è±¡ä»£ç å†—ä½™çš„é—®é¢˜ï¼Œ ä½†å´æ²¡æœ‰è§£å†³å¯¹è±¡è¯†åˆ«çš„é—®é¢˜ï¼ˆå³æ€æ ·çŸ¥é“ä¸€ä¸ªå¯¹è±¡çš„ç±»å‹ï¼‰ã€‚

# æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡

åˆ›å»ºå¯¹è±¡çš„æœ€ä½³å®è·µæ–¹æ¡ˆï¼Œåˆ™æ˜¯åˆ©ç”¨**æ„é€ å‡½æ•°**ã€‚

**æ‰€è°“çš„æ„é€ å‡½æ•°å…¶å®å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„å‡½æ•°å‰é¢åŠ äº† new è¿ç®—ç¬¦ï¼Œå…¶å®è´¨ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æ„é€ å‡½æ•°éƒ½æœ‰å‡½æ•°çš„ prototype å±æ€§ã€‚**

**å®ä¾‹å°±æ˜¯é€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡ã€‚**

```js
function Person(name, age) {
  this.name = name;
  this.age = age;
  this.sayName = function () {
    console.log(this.name);
  };
}
var p1 = new Person('å¼ ä¸‰', 18);
p1.sayName(); // => å¼ ä¸‰
var p2 = new Person('æå››', 23);
p2.sayName(); // => æå››
```

#### æ„é€ å‡½æ•°ç‰¹ç‚¹

- æ²¡æœ‰æ˜¾ç¤ºçš„åˆ›å»ºå¯¹è±¡
- ç›´æ¥å°†å±æ€§å’Œæ–¹æ³•èµ‹ç»™äº† `this` å¯¹è±¡
- æ²¡æœ‰ `return` è¯­å¥
- å‡½æ•°åä½¿ç”¨çš„æ˜¯å¤§å†™çš„ `Person`

#### æ„é€ å‡½æ•°æ‰§è¡Œæ­¥éª¤

1. ä½¿ç”¨ `new` æ“ä½œç¬¦åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚

2. å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹ç»™æ–°å¯¹è±¡ï¼ˆå› æ­¤ this å°±æŒ‡å‘äº†è¿™ä¸ªæ–°å¯¹è±¡ï¼‰ã€‚

3. æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ã€‚

4. è¿”å›æ–°å¯¹è±¡ã€‚

```js
// ä¼ªä»£ç æ¼”ç¤º
function Person(name, age) {
  // å½“ä½¿ç”¨ new æ“ä½œç¬¦è°ƒç”¨ Person() çš„æ—¶å€™ï¼Œå®é™…ä¸Šè¿™é‡Œä¼šå…ˆåˆ›å»ºä¸€ä¸ªå¯¹è±¡
  // var instance = {}
  // ç„¶åè®©å†…éƒ¨çš„ this æŒ‡å‘ instance å¯¹è±¡
  // this = instance
  // æ¥ä¸‹æ¥æ‰€æœ‰é’ˆå¯¹ this çš„æ“ä½œå®é™…ä¸Šæ“ä½œçš„å°±æ˜¯ instance
  this.name = name;
  this.age = age;
  this.sayName = function () {
    console.log(this.name);
  }; // åœ¨å‡½æ•°çš„ç»“å°¾å¤„ä¼šå°† this è¿”å›ï¼Œä¹Ÿå°±æ˜¯ instance // return this
}
```

#### æ„é€ å‡½æ•°ç¤ºä¾‹

```js
function Person(name, age) {
  this.name = name;
  this.age = age;
  this.sayName = function () {
    console.log(this.name);
  };
}
var p1 = new Person('å¼ ä¸‰', 18);
p1.sayName(); // => å¼ ä¸‰
var p2 = new Person('æå››', 23);
p2.sayName(); // => æå››

console.log(p1.constructor === Person); // å˜é‡p1çš„æ„é€ å™¨æ˜¯Personï¼Œè¿”å›true
console.log(p2.constructor === Person); // å˜é‡p2çš„æ„é€ å™¨æ˜¯Personï¼Œè¿”å›true
console.log(p1.constructor === p2.constructor); // å˜é‡p1å’Œp2çš„æ„é€ å™¨ç›¸åŒ

console.log(p1 instanceof Person); // è¿”å› true
console.log(p2 instanceof Person); // è¿”å› true
```

ä¸Šè¾¹çš„ä»£ç ï¼Œä»è¡¨é¢çœ‹ä¸Šå¥½åƒæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å®é™…ä¸Šè¿™æ ·åšï¼Œæœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¼Šç«¯ã€‚ **é‚£å°±æ˜¯å¯¹äºæ¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œ`type` å’Œ `sayHello` éƒ½æ˜¯ä¸€æ¨¡ä¸€æ ·çš„å†…å®¹ï¼Œ æ¯ä¸€æ¬¡ç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œéƒ½å¿…é¡»ä¸ºé‡å¤çš„å†…å®¹ï¼Œå¤šå ç”¨ä¸€äº›å†…å­˜ï¼Œå¦‚æœå®ä¾‹å¯¹è±¡å¾ˆå¤šï¼Œä¼šé€ æˆæå¤§çš„å†…å­˜æµªè´¹ã€‚**

```js
function Person(name, age) {
  this.name = name;
  this.age = age;
  this.type = 'å­¦ç”Ÿ';
  this.sayHello = function () {
    console.log('hello ' + this.name);
  };
}
var p1 = new Person('ç‹äº”', 18);
var p2 = new Person('æå››', 16);

console.log(p1.sayHello === p2.sayHello); // => false
```

æœ‰ä»€ä¹ˆå¥½çš„è§£å†³åŠæ³•å‘¢ï¼Ÿ**æ›´å¥½çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ `prototype`**ã€‚

**Javascript è§„å®šï¼Œæ¯ä¸€ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ª `prototype` å±æ€§ï¼ŒæŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ã€‚ è¿™ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œéƒ½ä¼šè¢«æ„é€ å‡½æ•°çš„å®ä¾‹ç»§æ‰¿ã€‚**

è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰å¯¹è±¡å®ä¾‹éœ€è¦å…±äº«çš„å±æ€§å’Œæ–¹æ³•ç›´æ¥å®šä¹‰åœ¨ `prototype` å¯¹è±¡ä¸Šã€‚

```js
function Person(name, age) {
  this.name = name;
  this.age = age;
}
console.log(Person.prototype); // è¿”å› { constructor:{...}, _proto_:{...} }
Person.prototype.type = 'å­¦ç”Ÿ';
Person.prototype.sayName = function () {
  console.log(this.name);
};
var p1 = new Person('ç‹äº”', 18);
var p2 = new Person('æå››', 16);
console.log(p1.sayName === p2.sayName); // => true
```

è¿™æ—¶æ‰€æœ‰å®ä¾‹çš„ **`type` å±æ€§å’Œ `sayName()` æ–¹æ³•**ï¼Œ å…¶å®éƒ½æ˜¯åŒä¸€ä¸ªå†…å­˜åœ°å€ï¼ŒæŒ‡å‘ `prototype` å¯¹è±¡ï¼Œå› æ­¤å°±æé«˜äº†è¿è¡Œæ•ˆç‡ã€‚

# åŸå‹å’ŒåŸå‹é“¾

## åŸå‹

**åŸå‹çš„ä½œç”¨ï¼šæ•°æ®å…±äº«ã€èŠ‚çœå†…å­˜ã€‚**

æ‰€è°“çš„æ„é€ å‡½æ•°å…¶å®å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„å‡½æ•°å‰é¢åŠ äº† new è¿ç®—ç¬¦ï¼Œå…¶å®è´¨ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æ„é€ å‡½æ•°éƒ½æœ‰å‡½æ•°çš„ prototype å±æ€§ã€‚å®ä¾‹å°±æ˜¯é€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡ã€‚

**prototype å±æ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯åŸå‹å¯¹è±¡ã€‚**

**è‡³äºæ˜¯è°çš„åŸå‹å¯¹è±¡ï¼Œéœ€è¦é å‡½æ•°çš„ prototype å±æ€§å’Œå®ä¾‹çš„\_\_proto\_\_å±æ€§æ¥ç¡®å®šã€‚**

**åŸå‹å¯¹è±¡ä¸Šé»˜è®¤æœ‰ä¸€ä¸ªå±æ€§ constructor,è¯¥å±æ€§ä¹Ÿæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å…¶ç›¸å…³è”çš„æ„é€ å‡½æ•°ã€‚**

```js
function People() {
  this.type = 'äºº';
}
People.prototype.showType = function () {
  console.log(this.type);
};
var person = new People(); //è°ƒç”¨åŸå‹å¯¹è±¡ä¸Šé¢çš„æ–¹æ³•
person.showType(); //æœ€åç»“æœå¼¹æ¡†å¼¹å‡ºäºº
People.prototype.constructor == People; //è¿”å›true
```

![image-20210328184543428](assets/image-20210328184543428.png)

> [!note]
>
> - æ„é€ å‡½æ•°çš„ prototype æ˜¯æŒ‡é’ˆï¼ŒæŒ‡å‘çš„æ˜¯åŸå‹å¯¹è±¡ã€‚
>
> - åŸå‹å¯¹è±¡çš„ constructor ä¹Ÿæ˜¯æŒ‡é’ˆï¼ŒæŒ‡å‘çš„æ˜¯æ„é€ å‡½æ•°ã€‚
>
> - å®ä¾‹çš„\_proto\_æŒ‡é’ˆä¹ŸæŒ‡å‘åŸå‹å¯¹è±¡ã€‚

## åŸå‹é“¾

ä»å®ä¾‹å¼€å§‹ï¼Œå®ä¾‹çš„`_proto_`æŒ‡é’ˆæŒ‡å‘åŸå‹å¯¹è±¡ï¼ŒåŸå‹å¯¹è±¡ä¹Ÿå­˜åœ¨`_proto_`æŒ‡é’ˆæŒ‡å‘ä¸Šä¸€å±‚çš„åŸå‹å¯¹è±¡ã€‚åé¢ä¹Ÿä»¥æ­¤ç±»æ¨ï¼Œä¸€ç›´åˆ° Object.prototype è¿™ä¸ªåŸå‹ä¸ºæ­¢ï¼ŒObject.prototype ä¸ºåŸå‹é“¾çš„æœ«å°¾ç‚¹ã€‚

```js
function People() {
  this.name = 'Jane';
}
var person = new People();
```

![image-20210328191300366](assets/image-20210328191300366.png)

> [!note]
>
> - person å®ä¾‹çš„\_proto\_å±æ€§æŒ‡å‘åŸå‹å¯¹è±¡
>
> - åŸå‹å¯¹è±¡çš„\_proto\_æŒ‡å‘ä¸Šä¸€å±‚ Object åŸå‹å¯¹è±¡ã€‚
>
> - Object åŸå‹å¯¹è±¡çš„æ„é€ å‡½æ•°æ˜¯ Objectï¼Œä¸ºè¯¥åŸå‹é“¾çš„æœ«ç«¯ã€‚

## instanceof çš„åŸç†

instanceof å¯ä»¥åˆ¤æ–­å®ä¾‹å¯¹è±¡çš„\_proto\_å±æ€§æ˜¯å¦ä¸æ„é€ å‡½æ•°çš„ prototype å±æ€§æŒ‡å‘åŒä¸€åœ°å€ï¼Œæ˜¯çš„è¯è¿”å› trueï¼Œå¦åˆ™ fasleã€‚

```js
// å®ä¾‹ instanceof æ„é€ å‡½æ•°
person instanceof People;
```

## constructor æ„é€ å™¨

å®ä¾‹çš„\_proto\_å±æ€§æ‰¾åˆ°åŸå‹å¯¹è±¡ï¼ŒåŸå‹å¯¹è±¡çš„ constructor å±æ€§æ‰¾åˆ°æ„é€ å‡½æ•°ã€‚

```js
person._proto_.constructor == People;
```

## æ›´ç®€å•çš„åŸå‹è¯­æ³•

```js
function Person(name, age) {
  this.name = name;
  this.age = age;
}
Person.prototype = {
  type: 'å­¦ç”Ÿ',
  sayHello: function () {
    console.log('æˆ‘å«' + this.name + 'ï¼Œæˆ‘ä»Šå¹´' + this.age + 'å²äº†');
  },
};
```

åœ¨è¯¥ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°† `Person.prototype` é‡ç½®åˆ°äº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚ è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯ä¸º `Person.prototype` æ·»åŠ æˆå‘˜ç®€å•äº†ï¼Œä½†æ˜¯ä¹Ÿä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯åŸå‹å¯¹è±¡ä¸¢å¤±äº† `constructor` æˆå‘˜ã€‚

**æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸ºäº†ä¿æŒ `constructor` çš„æŒ‡å‘æ­£ç¡®ï¼Œå»ºè®®çš„å†™æ³•æ˜¯**ï¼š

```js
function Person(name, age) {
  this.name = name;
  this.age = age;
}

Person.prototype = {
  constructor: Person, // => æ‰‹åŠ¨å°† constructor æŒ‡å‘æ­£ç¡®çš„æ„é€ å‡½æ•°
  type: 'å­¦ç”Ÿ',
  sayHello: function () {
    console.log('æˆ‘å«' + this.name + 'ï¼Œæˆ‘ä»Šå¹´' + this.age + 'å²äº†');
  },
};
```

## åŸç”Ÿå¯¹è±¡çš„åŸå‹

```js
// ä¸ºå†…ç½®å¯¹è±¡æ·»åŠ åŸå‹æ–¹æ³•
// æˆ‘ä»¬åœ¨ç³»ç»Ÿçš„å¯¹è±¡çš„åŸå‹ä¸­æ·»åŠ æ–¹æ³•,ç›¸å½“äºåœ¨æ”¹å˜æºç 
// æˆ‘å¸Œæœ›å­—ç¬¦ä¸²ä¸­æœ‰ä¸€ä¸ªå€’åºå­—ç¬¦ä¸²çš„æ–¹æ³•
String.prototype.myReverse = function () {
  for (var i = this.length - 1; i >= 0; i--) {
    console.log(this[i]);
  }
};
var str = 'abcdefg';
str.myReverse();

// ä¸ºArrayå†…ç½®å¯¹è±¡çš„åŸå‹å¯¹è±¡ä¸­æ·»åŠ æ–¹æ³•
Array.prototype.mySort = function () {
  for (var i = 0; i < this.length - 1; i++) {
    for (var j = 0; j < this.length - 1 - i; j++) {
      if (this[j] < this[j + 1]) {
        var temp = this[j];
        this[j] = this[j + 1];
        this[j + 1] = temp;
      } //end if
    } // end for
  } //end for
};
var arr = [100, 3, 56, 78, 23, 10];
arr.mySort();
console.log(arr);

String.prototype.sayHi = function () {
  console.log(this + 'å“ˆå“ˆ,æˆ‘åˆå˜å¸…äº†');
};
// å­—ç¬¦ä¸²å°±æœ‰äº†æ‰“æ‹›å‘¼çš„æ–¹æ³•
var str2 = 'Truffle';
str2.sayHi();
```

# ç»§æ‰¿

**ç»§æ‰¿æ˜¯ä¸€ç§ç±»(class)ä¸ç±»ä¹‹é—´çš„å…³ç³»ï¼ŒJS ä¸­æ²¡æœ‰ç±»ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°æ¨¡æ‹Ÿç±»ï¼Œç„¶åé€šè¿‡åŸå‹æ¥å®ç°ç»§æ‰¿ï¼Œç»§æ‰¿æ˜¯ä¸ºäº†å®ç°æ•°æ®å…±äº«ï¼ŒJS ä¸­çš„ç»§æ‰¿å½“ç„¶ä¹Ÿæ˜¯ä¸ºäº†å®ç°æ•°æ®å…±äº«ã€‚**

## åŸå‹ç»§æ‰¿

```js
function Person(name, age, sex, weight) {
  this.name = name;
  this.age = age;
  this.sex = sex;
  this.weight = weight;
}
Person.prototype.sayHi = function () {
  console.log('ä½ å¥½å¸…å‘€!!!');
};

function Student(score) {
  this.score = score;
}
// å¸Œæœ› Person ä¸­çš„æ•°æ®å¯ä»¥å…±äº«ç»™ Student â€”â€”â€”â€” ç»§æ‰¿
Student.prototype = new Person('å°ä¸‰', 18, 'ç”·', '58kg');

var stu1 = new Student('99');
console.log(stu1.name, stu1.age, stu1.sex, stu1.weight, stu1.score);
stu1.sayHi();

var stu2 = new Student('89');
console.log(stu2.name, stu2.age, stu2.sex, stu2.weight, stu2.score);
stu2.sayHi();

var stu3 = new Student('66');
console.log(stu3.name, stu3.age, stu3.sex, stu3.weight, stu3.score);
stu3.sayHi();
```

## æ„é€ å‡½æ•°ç»§æ‰¿

åœ¨ä¸Šè¾¹çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬ä¸ºäº†æ•°æ®å…±äº«,æ”¹å˜äº†åŸå‹æŒ‡å‘,åšåˆ°äº†ç»§æ‰¿ï¼Œå³é€šè¿‡æ”¹å˜åŸå‹æŒ‡å‘å®ç°äº†ç»§æ‰¿ã€‚è¿™å¯¼è‡´äº†ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬æ”¹å˜åŸå‹æŒ‡å‘çš„åŒæ—¶,ç›´æ¥åˆå§‹åŒ–äº†å±æ€§ï¼Œè¿™æ ·ç»§æ‰¿è¿‡æ¥çš„å±æ€§çš„å€¼éƒ½æ˜¯ä¸€æ ·çš„äº†ã€‚è¿™æ˜¯ä¸ªé—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ”¹å˜ç»§æ‰¿è¿‡æ¥çš„å€¼ï¼Œåªèƒ½é‡æ–°è°ƒç”¨å¯¹è±¡çš„å±æ€§è¿›è¡Œé‡æ–°èµ‹å€¼ï¼Œè¿™åˆå¯¼è‡´æˆ‘ä»¬ä¸Šè¾¹çš„åˆå§‹åŒ–å¤±å»äº†æ„ä¹‰ã€‚

**å¦‚ä½•è§£å†³ä¸Šè¾¹çš„é—®é¢˜å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å€Ÿç”¨æ„é€ å‡½æ•°å®ç°ç»§æ‰¿ã€‚**
ç»§æ‰¿çš„æ—¶å€™,ä¸æ”¹å˜åŸå‹çš„æŒ‡å‘,ç›´æ¥è°ƒç”¨çˆ¶çº§çš„æ„é€ å‡½æ•°æ¥ä¸ºå±æ€§èµ‹å€¼ï¼Œå³æŠŠè¦ç»§æ‰¿çš„çˆ¶çº§çš„æ„é€ å‡½æ•°æ‹¿è¿‡æ¥,å€Ÿç”¨ä¸€ä¸‹ä¸ºå±æ€§èµ‹å€¼ï¼Œè¿™å«åšå€Ÿç”¨æ„é€ å‡½æ•°ã€‚å€Ÿç”¨æ„é€ å‡½æ•°éœ€è¦ä½¿ç”¨ call ()è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä¼šåœ¨åè¾¹çš„æ–‡ç« ä¸­è¿›è¡Œè®²è§£ï¼Œå¤§å®¶åœ¨è¿™é‡Œå…ˆè®°ä½ç”¨æ³•å°±è¡Œäº†ã€‚

```js
function Person(name, age, sex, weight) {
  this.name = name;
  this.age = age;
  this.sex = sex;
  this.weight = weight;
}
Person.prototype.sayHi = function () {
  console.log('ä½ å¥½å¸…å‘€!!!');
};

function Student(name, age, sex, weight, score) {
  // â˜†â˜†â˜† å€Ÿç”¨æ„é€ å‡½æ•° â˜†â˜†â˜†
  Person.call(this, name, age, sex, weight);
  this.score = score;
}
var stu1 = new Student('å°ä¸‰', 16, 'ç”·', '50kg', '110');
console.log(stu1.name, stu1.age, stu1.sex, stu1.weight, stu1.score);

var stu2 = new Student('å°çº¢', 22, 'å¥³', '45kg', '88');
console.log(stu2.name, stu2.age, stu2.sex, stu2.weight, stu2.score);

var stu3 = new Student('å°èˆ', 16, 'å¥³', '40kg', '100');
console.log(stu3.name, stu3.age, stu3.sex, stu3.weight, stu3.score);
```

**å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿,è§£å†³äº†ç»§æ‰¿çš„æ—¶å€™å±æ€§é‡å¤çš„é—®é¢˜ã€‚ä½†æ˜¯è¿™åˆå¯¼è‡´ä¸€ä¸ªé—®é¢˜å³çˆ¶ç±»ä¸­çš„åŸå‹æ–¹æ³•ä¸èƒ½è¢«ç»§æ‰¿ã€‚**

## ç»„åˆç»§æ‰¿

åŸå‹ç»§æ‰¿å’Œå€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿éƒ½å­˜åœ¨å„è‡ªçš„ç¼ºç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äºŒè€…ç»“åˆåˆ°ä¸€èµ·ï¼Œä»è€Œå‘æŒ¥äºŒè€…ä¹‹é•¿ã€‚å³åœ¨ç»§æ‰¿è¿‡ç¨‹ä¸­ï¼Œæ—¢å¯ä»¥ä¿è¯æ¯ä¸ªå®ä¾‹éƒ½æœ‰å®ƒè‡ªå·±çš„å±æ€§ï¼Œåˆèƒ½åšåˆ°å¯¹ä¸€äº›å±æ€§å’Œæ–¹æ³•çš„å¤ç”¨ã€‚

è¿™æ—¶ç»„åˆç»§æ‰¿åº”è¿è€Œç”Ÿï¼Œ**ç»„åˆç»§æ‰¿=åŸå‹ç»§æ‰¿+æ„é€ å‡½æ•°ç»§æ‰¿**ã€‚

```js
function Person(name, age, sex) {
  this.name = name;
  this.age = age;
  this.sex = sex;
}
Person.prototype.sayHi = function () {
  console.log('ä½ å¥½å¸…å‘€!!!');
};

function Student(name, age, sex, score) {
  //å€Ÿç”¨æ„é€ å‡½æ•°:è§£å†³å±æ€§å€¼é‡å¤çš„é—®é¢˜
  Person.call(this, name, age, sex);
  this.score = score;
}
//æ”¹å˜åŸå‹æŒ‡å‘---åŸå‹ç»§æ‰¿è§£å†³åŸå‹æ–¹æ³•ä¸èƒ½è¢«ç»§æ‰¿é—®é¢˜
Student.prototype = new Person(); //ä¸ä¼ å€¼
Student.prototype.eat = function () {
  console.log('åƒåƒåƒ!!!');
};
var stu = new Student('å°ä¸‰', 16, 'ç”·', '111åˆ†');
console.log(stu.name, stu.age, stu.sex, stu.score);
stu.sayHi();
stu.eat();
var stu2 = new Student('å°èˆ', 15, 'å¥³', '1111åˆ†');
console.log(stu2.name, stu2.age, stu2.sex, stu2.score);
stu2.sayHi();
stu2.eat();
```

## æ‹·è´ç»§æ‰¿ï¼ˆfor-inï¼‰

æ‹·è´ç»§æ‰¿ï¼šæŠŠä¸€ä¸ªå¯¹è±¡ä¸­çš„å±æ€§æˆ–è€…æ–¹æ³•ç›´æ¥å¤åˆ¶åˆ°å¦ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚

```js
function Person() {}
Person.prototype.name = 'å°ä¸‰';
Person.prototype.age = 18;
Person.prototype.sex = 'ç”·';
Person.prototype.height = 100;
Person.prototype.play = function () {
  console.log('ç©çš„å¥½å¼€å¿ƒå‘€!!!ğŸ˜ƒ');
};
var obj = {};
// Personä¸­æœ‰åŸå‹prototype,prototypeå°±æ˜¯ä¸€ä¸ªå¯¹è±¡,é‚£ä¹ˆé‡Œé¢,name,age,sex,height,playéƒ½æ˜¯è¯¥å¯¹è±¡ä¸­çš„å±æ€§æˆ–è€…æ–¹æ³•
// æ–°å¯¹è±¡objé€šè¿‡æ‹·è´Personä¸­åŸå‹prototypeå¯¹è±¡ä¸­çš„å±æ€§å’Œæ–¹æ³•ç»§æ‰¿Personä¸­åŸå‹prototypeå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•
for (var key in Person.prototype) {
  obj[key] = Person.prototype[key];
}
console.dir(obj);
obj.play();
```

> [!note]
>
> åŸå‹é“¾æ˜¯ä¸€ç§å…³ç³»ï¼Œæ˜¯å®ä¾‹å¯¹è±¡å’ŒåŸå‹å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œè¿™ç§å…³ç³»æ˜¯é€šè¿‡åŸå‹(\_proto\_)æ¥è”ç³»çš„ã€‚
>
> ç»§æ‰¿æ˜¯ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»ï¼ŒJS ä¸æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œæ²¡æœ‰ç±»ä½†å¯ä»¥é€šè¿‡å‡½æ•°æ¨¡æ‹Ÿç±»ï¼Œæ¨¡æ‹Ÿé¢å‘å¯¹è±¡ä¸­çš„ç»§æ‰¿ã€‚
>
> æ¨¡æ‹Ÿç»§æ‰¿æ˜¯ä¸ºäº†å®ç°æ•°æ®å…±äº«ï¼ŒèŠ‚çœå†…å­˜ç©ºé—´ã€‚
>
> JS ä¸­çš„ç»§æ‰¿æ–¹å¼ï¼š
>
> - åŸå‹ç»§æ‰¿ï¼šé€šè¿‡æ”¹å˜åŸå‹çš„æŒ‡å‘å®ç°ç»§æ‰¿ã€‚
> - å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿ï¼šä¸»è¦è§£å†³å±æ€§é‡å¤çš„é—®é¢˜ï¼Œä¼šå¯¼è‡´çˆ¶ç±»ä¸­çš„åŸå‹æ–¹æ³•ä¸èƒ½ç»§æ‰¿ã€‚
> - ç»„åˆç»§æ‰¿ï¼šåŸå‹ç»§æ‰¿+å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿ï¼Œæ—¢èƒ½è§£å†³å±æ€§é‡å¤é—®é¢˜,åˆèƒ½è§£å†³æ–¹æ³•ä¸èƒ½è¢«ç»§æ‰¿çš„é—®é¢˜ã€‚
> - æ‹·è´ç»§æ‰¿ï¼šæŠŠå¯¹è±¡ä¸­éœ€è¦å…±äº«çš„å±æ€§æˆ–æ–¹æ³•,ç›´æ¥é€šè¿‡éå†çš„æ–¹å¼å¤åˆ¶åˆ°å¦ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚

# å‡½æ•°

## å‡½æ•°å£°æ˜

#### ç›´æ¥å£°æ˜

```js
// ç›´æ¥å£°æ˜
function fn() {
  console.log('æˆ‘æ˜¯JSä¸­çš„ä¸€ç­‰å…¬æ°‘-å‡½æ•°!!!å“ˆå“ˆ');
}
fn();
```

#### å˜é‡å£°æ˜

```js
// å˜é‡å£°æ˜
var fn = function () {
  console.log('æˆ‘æ˜¯JSä¸­çš„ä¸€ç­‰å…¬æ°‘-å‡½æ•°!!!å“ˆå“ˆ');
};
fn();
```

#### Function æ„é€ å‡½æ•°åˆ›å»ºå®ä¾‹ï¼ˆâŒï¼‰

```js
// Functionæ„é€ å‡½æ•°åˆ›å»ºå®ä¾‹
// new Function(arg1,arg2,arg3..,å‡½æ•°ä½“);
var f1 = new Function('num1', 'num2', 'return num1+num2');
console.log(f1(10, 20));
console.log(f1.__proto__ == Function.prototype);
// æ‰€ä»¥,å‡½æ•°å®é™…ä¸Šä¹Ÿæ˜¯å¯¹è±¡
console.dir(f1);
console.dir(Function);
```

## å‡½æ•°è°ƒç”¨

#### æ™®é€šå‡½æ•°

```js
// æ™®é€šå‡½æ•°
function f1() {
  console.log('æˆ‘æ˜¯æ™®é€šå‡½æ•°');
}
f1();
```

#### æ„é€ å‡½æ•°

```js
// æ„é€ å‡½æ•°---é€šè¿‡new æ¥è°ƒç”¨,åˆ›å»ºå¯¹è±¡
function F1() {
  console.log('æˆ‘æ˜¯æ„é€ å‡½æ•°');
}
var f = new F1();
```

#### å¯¹è±¡æ–¹æ³•

```js
// å¯¹è±¡çš„æ–¹æ³•
function Person() {
  this.play = function () {
    console.log('æˆ‘æ˜¯å¯¹è±¡ä¸­çš„æ–¹æ³•');
  };
}
var per = new Person();
per.play();
```

## this æŒ‡å‘

**å‡½æ•°çš„è°ƒç”¨æ–¹å¼å†³å®šäº† `this` æŒ‡å‘çš„ä¸åŒ**

| è°ƒç”¨æ–¹å¼          | æµè§ˆå™¨                                          | Node.js          |
| :---------------- | :---------------------------------------------- | :--------------- |
| å…¨å±€ this         | window                                          | {} å®é™…æ˜¯ module |
| å‡½æ•°ä¸­çš„ this     | undefinedï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰<br />windowï¼ˆéä¸¥æ ¼æ¨¡å¼ï¼‰ | å…¨å±€ global      |
| æ„é€ å‡½æ•°ä¸­çš„ this | å®ä¾‹å¯¹è±¡                                        | å®ä¾‹å¯¹è±¡         |
| å®šæ—¶å™¨å‡½æ•°        | window                                          | Timeout          |

```js
// æ™®é€šå‡½æ•°
function f1() {
  console.log(this); // window | ä¸¥æ ¼æ¨¡å¼ä¸‹undefined
}
f1();

// æ„é€ å‡½æ•°
function Person() {
  console.log(this); // Person
  // å¯¹è±¡çš„æ–¹æ³•
  this.sayHi = function () {
    console.log(this); // Person
  };
}

// å®šæ—¶å™¨ä¸­çš„this
setInterval(function () {
  console.log(this); // window
}, 1000);
```

## call å’Œ apply

**`call()`å’Œ`apply()`ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼Œå¯ä»¥æ”¹å˜ this çš„æŒ‡å‘ã€‚**

> [!note]
>
> call( æŒ‡å®š this, [å‚æ•°æ•°ç»„] )
>
> apply( æŒ‡å®š this, å‚æ•° 1, å‚æ•° 2 ... )

```js
function Person(name, sex) {
  this.name = name;
  this.sex = sex;
}
//é€šè¿‡åŸå‹æ·»åŠ æ–¹æ³•
Person.prototype.sayHi = function (x, y) {
  console.log('æ‚¨å¥½å•Š:' + this.name);
  return x + y;
};
var per = new Person('å°ä¸½', 'ç”·');
var r1 = per.sayHi(10, 20); // æ„é€ å‡½æ•°çš„thisï¼Œä¸ºå®ä¾‹per

function Student(name, age) {
  this.name = name;
  this.age = age;
}
var stu = new Student('å°ç‹', 18);
var r2 = per.sayHi.apply(stu, [10, 20]); // thisæŒ‡å‘stu
var r3 = per.sayHi.call(stu, 10, 20); // thisæŒ‡å‘stu

console.log(r1);
console.log(r2);
console.log(r3);
```

_å¦‚æœæƒ³ä½¿ç”¨åˆ«çš„å¯¹è±¡çš„æ–¹æ³•ï¼Œå¹¶ä¸”å¸Œæœ›è¿™ä¸ªæ–¹æ³•æ˜¯å½“å‰å¯¹è±¡çš„ï¼Œå°±å¯ä»¥ä½¿ç”¨ apply æˆ–è€…æ˜¯ call æ–¹æ³•æ”¹å˜ this çš„æŒ‡å‘ã€‚_

## bind

`bind()`æ–¹æ³•æ˜¯ç»‘å®šçš„æ„æ€ï¼Œæœ¬è´¨æ˜¯åˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°ï¼ˆæˆä¸ºâ€**ç»‘å®šå‡½æ•°**â€œï¼‰ï¼Œå‚æ•°å¯ä»¥åœ¨å¤åˆ¶çš„æ—¶å€™ä¼ è¿›å»ï¼Œä¹Ÿå¯ä»¥åœ¨å¤åˆ¶ä¹‹åè°ƒç”¨çš„æ—¶å€™ä¼ å…¥è¿›å»ã€‚

**`bind()`æ–¹æ³•ï¼Œæ˜¯å¤åˆ¶ä¸€ä»½çš„æ—¶å€™ï¼Œæ”¹å˜äº† this çš„æŒ‡å‘ã€‚**

```js
function Person(name) {
  this.name = name;
}
Person.prototype.play = function () {
  console.log(this + '====>' + this.name);
};

function Student(name) {
  this.name = name;
}
var per = new Person('äºº');
var stu = new Student('å­¦ç”Ÿ');
per.play();
// å¤åˆ¶äº†ä¸€ä¸ªæ–°çš„playæ–¹æ³•
var ff = per.play.bind(stu);
ff();
```

> [!note]
>
> å‡½æ•°æ˜¯å¯¹è±¡ï¼Œå¯¹è±¡ä¸ä¸€å®šæ˜¯å‡½æ•°ã€‚
>
> å¯¹è±¡ä¸­æœ‰`_proto_`å±æ€§ï¼Œå‡½æ•°ä¸­æœ‰ prototype å±æ€§ã€‚
>
> applyï¼Œcallï¼Œbind æ–¹æ³•æ˜¯ç”¨æ¥æ”¹å˜ this æŒ‡å‘çš„ã€‚
>
> apply å’Œ call æ˜¯è°ƒç”¨æ–¹æ³•çš„æ—¶å€™æ”¹å˜ this æŒ‡å‘ã€‚
>
> bind æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°çš„æ—¶å€™æ”¹å˜ this çš„æŒ‡å‘ã€‚

# å†…å­˜

## å†…å­˜å­˜å‚¨

JS åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼ŒåŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ã€‚

| åŸºæœ¬ç±»å‹                                                                                                     | å¼•ç”¨ç±»å‹                                                                                 |
| ------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------- |
| â— å­—ç¬¦ä¸² String<br />â— æ•°å­— Number<br />â— å¸ƒå°” Boolean<br />â— å¯¹ç©º Null<br />â— æœªå®šä¹‰ Undefined<br />â—Symbol | â— å¯¹è±¡ Object<br />â— æ•°ç»„ Array<br />â— å‡½æ•° Function<br />â— æ—¥æœŸ Date<br />â— æ­£åˆ™ RegExp |

### æ ˆå†…å­˜å’Œå †å†…å­˜

æ ˆå†…å­˜ï¼šå­˜å‚¨åŸºæœ¬ç±»å‹çš„å˜é‡å€¼å’Œå¼•ç”¨ç±»å‹çš„å˜é‡å€¼åœ°å€ã€‚

å †å†…å­˜ï¼šå­˜å‚¨å¼•ç”¨ç±»å‹çš„å˜é‡å€¼ã€‚

```js
const num = 1;
const obj = {
  key: 'val',
};
num = 2; // TypeError: Assignment to constant variable.
obj.key = 'val1'; // èµ‹å€¼æˆåŠŸ
```

![image-20210329172853903](assets/image-20210329172853903.png)

num å’Œ null_val ä¸¤ä¸ªå˜é‡éƒ½æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ‰€ä»¥ï¼Œç›´æ¥åœ¨æ ˆå†…å­˜ä¸­å­˜å‚¨å€¼ã€‚

obj æ˜¯å¼•ç”¨ç±»å‹ï¼Œåœ¨æ ˆå†…å­˜ä¸­å­˜å‚¨åœ°å€ï¼Œå †å†…å­˜ä¸­å­˜å‚¨å€¼ã€‚

> [!note]
>
> null è™½ç„¶æ˜¯ object ç±»å‹ï¼Œä½†æ˜¯ä»ç„¶å­˜å‚¨åœ¨æ ˆå†…å­˜ä¸­ã€‚
>
> obj è™½ç„¶æ˜¯ const å®šä¹‰ï¼Œä½†æ˜¯å…¶å­˜å‚¨çš„æ˜¯æŒ‡é’ˆåœ°å€ï¼Œè¿™ä¸ªåœ°å€ä¸å¯ä»¥æ”¹å˜ï¼Œä½†æ˜¯åœ°å€å¯¹åº”çš„å †å†…å­˜ä¸­çš„æ•°æ®ï¼Œæ˜¯å¯ä»¥æ”¹å˜çš„ã€‚æ‰€ä»¥ obj.key ä»ç„¶å¯ä»¥æ”¹å˜å…¶å€¼ã€‚
>
> **æ‰€ä»¥ï¼Œconst å®šä¹‰çš„å˜é‡å…¶å€¼ä¸å¯ä»¥æ”¹å˜è¿™ä¸ªè¯´æ³•ä¸å‡†ç¡®ã€‚**

### new å®šä¹‰çš„åŸºæœ¬ç±»å‹

new ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œæ„é€ å‡½æ•°ç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚

JS æä¾›äº†ä¸€äº›åŸºæœ¬ç±»å‹çš„æ„é€ å‡½æ•°ï¼Œæ¯”å¦‚ï¼ŒString\Number ç­‰ï¼Œé‚£ä¹ˆè¿™äº› new å‡ºæ¥çš„å˜é‡å’Œæ­£å¸¸å®šä¹‰çš„å˜é‡æœ‰ä½•ä¸åŒå‘¢ï¼Ÿ

è™½ç„¶ï¼Œä»–ä»¬è¡¨é¢ä¸Šçœ‹èµ·æ¥æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œå®é™…ä¸Šå†…éƒ¨å®Œå…¨ä¸åŒã€‚

new å‡ºæ¥çš„å˜é‡æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡å°±æ˜¯å¼•ç”¨ç±»å‹ï¼Œæ ˆå†…å­˜ä¸­å­˜å‚¨çš„æ˜¯åœ°å€ã€‚

æ­£å¸¸å®šä¹‰çš„å˜é‡å°±æ˜¯ä¸€ä¸ªåŸºæœ¬ç±»å‹å˜é‡ï¼Œæ ˆå†…å­˜ä¸­å­˜å‚¨çš„æ˜¯å˜é‡å€¼ã€‚

```js
const str1 = 'hello';
const str2 = new String('hello');
const str3 = new String('hello');
console.log(str1 == str2); // true
console.log(str2 == str3); // false
console.log(str1 === str2); // false
```

str1 å’Œ str2 è™½ç„¶è¡¨é¢ä¸€æ ·ï¼Œä½†æ˜¯ç±»å‹ä¸åŒï¼Œæ‰€ä»¥å¼±ç­‰äºï¼ˆ==ï¼‰æ˜¯ç›¸ç­‰çš„ï¼Œå¼ºç­‰äºï¼ˆ===ï¼‰æ˜¯ä¸ç­‰çš„ã€‚

str2 å’Œ str3 è™½ç„¶éƒ½æ˜¯ objectï¼Œä½†æ˜¯æ˜¯é€šè¿‡ new å‡ºæ¥çš„ï¼Œä»–ä»¬éƒ½æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆå­˜å‚¨çš„å°±æ˜¯åœ°å€ã€‚æ‰€ä»¥ï¼Œstr2 çš„åœ°å€ä¸ç­‰äº str3 çš„åœ°å€ã€‚

> [!danger]
>
> **ä¸å»ºè®®å¤§å®¶ä½¿ç”¨ new æ¥å®šä¹‰åŸºæœ¬ç±»å‹ã€‚**

## æ·±æ‹·è´ & æµ…æ‹·è´

ä¸åŒç±»å‹çš„å¤åˆ¶å˜é‡å€¼çš„æ–¹å¼æ˜¯ä¸åŒçš„ã€‚å¯¹äºåŸºæœ¬ç±»å‹ï¼Œä»ä¸€ä¸ªå˜é‡å‘å¦å¤–ä¸€ä¸ªæ–°å˜é‡å¤åˆ¶åŸºæœ¬ç±»å‹çš„å€¼ï¼Œä¼šåˆ›å»ºè¿™ä¸ªå€¼çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œå¹¶å°†è¯¥å‰¯æœ¬å¤åˆ¶ç»™æ–°å˜é‡ã€‚å¯¹äºå¼•ç”¨ç±»å‹ï¼Œä»ä¸€ä¸ªå˜é‡å‘å¦ä¸€ä¸ªæ–°å˜é‡å¤åˆ¶å¼•ç”¨ç±»å‹çš„å€¼ï¼Œå…¶å®å¤åˆ¶çš„æ˜¯æŒ‡é’ˆï¼Œæœ€ç»ˆä¸¤ä¸ªå˜é‡éƒ½æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚

### æµ…æ‹·è´

æµ…æ‹·è´å°±æ˜¯ç›´æ¥å¤åˆ¶ï¼Œç›¸å½“äºæŠŠä¸€ä¸ªå¯¹è±¡ä¸­çš„æ‰€æœ‰çš„å†…å®¹ï¼Œå¤åˆ¶ä¸€ä»½ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹äºåŸºæœ¬ç±»å‹å¤åˆ¶çš„æ˜¯å…·ä½“çš„å€¼çš„å‰¯æœ¬ï¼Œå¯¹äºå¼•ç”¨ç±»å‹å¤åˆ¶çš„æ˜¯æŒ‡é’ˆã€‚

```js
const obj1 = { key: 'val' };
const obj2 = obj1; // æµ…æ‹·è´ï¼Œobj1å’Œobj2çš„å€¼ä¼šäº’ç›¸å½±å“
```

![image-20210329172918782](assets/image-20210329172918782.png)

### æ·±æ‹·è´

æ·±æ‹·è´è¿˜æ˜¯å¤åˆ¶ï¼Œå¯¹äºåŸºæœ¬ç±»å‹å¤åˆ¶çš„æ˜¯å…·ä½“çš„å€¼çš„å‰¯æœ¬ï¼Œå¯¹äºå¼•ç”¨ç±»å‹ä¼šæ‰¾åˆ°å¯¹è±¡ä¸­å…·ä½“çš„å±æ€§æˆ–è€…æ–¹æ³•ï¼Œå¹¶ä¸”å¼€è¾Ÿæ–°çš„ç›¸åº”çš„ç©ºé—´ï¼Œä¸€ä¸ªä¸€ä¸ªçš„å¤åˆ¶åˆ°å¦ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦ä½¿ç”¨é€’å½’ã€‚

```js
function deepCopy = {
  // ......
}
const obj1 = { key: 'val' };
const obj2 = deepCopy(obj1);	// æ·±æ‹·è´
```

![image-20210329173024791](assets/image-20210329173024791.png)

### æ·±æ‹·è´å®ç°

#### ç¬¬ä¸‰æ–¹åº“

æµè§ˆå™¨ç«¯ä½¿ç”¨ jQuery.extend å®ç°ã€‚

Node.js ç¯å¢ƒä½¿ç”¨ lodash åº“å®ç°ã€‚

```js
// æµè§ˆå™¨ jQuery.extend
$.extend(true, object1, object2); // æ·±åº¦æ‹·è´
$.extend(object1, object2); // æµ…æ‹·è´

// Node.jsç¯å¢ƒ lodash åº“
var objects = [{ a: 1 }, { b: 2 }];
var deep = _.cloneDeep(objects);
console.log(deep[0] === objects[0]); // => false
```

#### JSON å¯¹è±¡

å¦‚æœæ˜¯ä¸€ä¸ª Object å¯¹è±¡æˆ–æ•°ç»„å®ç°æ·±æ‹·è´ï¼Œå¯ä»¥ç”¨`JSON.stringify()`å’Œ`JSON.parse()`æ¥å®ç°æ·±æ‹·è´ã€‚

```js
var obj1 = {
  name: 'shen',
};
var obj2 = JSON.parse(JSON.stringify(obj1));
obj2.name = 'shenzhiyong';

console.log('obj1:', obj1); // obj1: {name: "shen"}
console.log('obj2:', obj2); // obj2: {name: "shenzhiyong"}
```

å¦‚æœå¯¹è±¡ä¸­æœ‰å‡½æ•°ï¼Œåˆ™è¯¥æ–¹æ³•ä¸å¯ç”¨ã€‚

```js
var obj1 = {
  name: 'shen',
  show: function (argument) {
    console.log(1);
  },
};
var obj2 = JSON.parse(JSON.stringify(obj1));
console.log('obj1:', obj1); // obj1: {name: "shen", show: Æ’}
console.log('obj2:', obj2); // obj2: {name: "shen"} // showæ²¡æœ‰æ‹·è´è¿‡æ¥
```

#### é€’å½’å®ç°

é€’å½’ç®€å•çš„æ¥è¯´å°±æ˜¯ç¨‹åºè‡ªå·±è°ƒç”¨è‡ªå·±ï¼Œå°±åƒä¸‹é¢è¿™å¹…å›¾ä¸€æ ·ï¼Œä¸€ç›´å¾ªç¯å¾€å¤ã€‚

![img](assets/format,png.gif)

å°±åƒæˆ‘ä»¬ç»å¸¸å¬åˆ°çš„å°å’Œå°šçš„æ•…äº‹ï¼Œä»å‰æœ‰åº§å±±ï¼Œå±±é‡Œæœ‰åº§åº™ï¼Œåº™é‡Œæœ‰ä¸ªè€å’Œå°šå’Œä¸€ä¸ªå°å’Œå°šï¼Œæœ‰ä¸€å¤©è€å’Œå°šå¯¹å°å’Œå°šè®²æ•…äº‹ï¼Œæ•…äº‹å†…å®¹æ˜¯ï¼šä»å‰æœ‰åº§å±±ï¼Œå±±é‡Œæœ‰åº§åº™ï¼Œåº™é‡Œæœ‰ä¸ªè€å’Œå°šå’Œä¸€ä¸ªå°å’Œå°šï¼Œæœ‰ä¸€å¤©è€å’Œå°šå¯¹å°å’Œå°šè®²æ•…äº‹ï¼Œæ•…äº‹å†…å®¹æ˜¯ï¼šä»å‰æœ‰åº§å±±ï¼Œå±±é‡Œæœ‰åº§åº™ï¼Œåº™é‡Œ......

JavaScript çš„é€’å½’å°±æ˜¯åœ¨å‡½æ•°ä¸­è°ƒç”¨å‡½æ•°è‡ªå·±ã€‚

```js
// é€’å½’:å‡½æ•°ä¸­è°ƒç”¨å‡½æ•°è‡ªå·±
function f1() {
  console.log(
    'ä»å‰æœ‰åº§å±±ï¼Œå±±é‡Œæœ‰åº§åº™ï¼Œåº™é‡Œæœ‰ä¸ªè€å’Œå°šå’Œä¸€ä¸ªå°å’Œå°šï¼Œæœ‰ä¸€å¤©è€å’Œå°šå¯¹å°å’Œå°šè®²æ•…äº‹ï¼Œæ•…äº‹å†…å®¹æ˜¯ï¼š'
  );
  f1(); // è°ƒç”¨è‡ªå·±
}

f1();
```

å¦‚æœç¨‹åºä¸€ç›´è¿™æ ·å¾ªç¯å¾€å¤çš„è°ƒç”¨è‡ªå·±ï¼Œä¸€ç›´éƒ½ä¸ç»“æŸï¼Œå°±æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ï¼Œè¿™æ²¡ä»€ä¹ˆæ„ä¹‰ã€‚

**æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸ºé€’å½’å®šä¹‰ä¸€ä¸ªç»“æŸæ¡ä»¶ï¼Œå³é€’å½’çš„å‡ºå£ï¼Œå½“æ¡ä»¶ä¸æ»¡è¶³æ—¶ï¼Œé€’å½’ä¸€ç›´å‰è¿›ï¼Œä¸æ–­åœ°è°ƒç”¨è‡ªå·±ï¼›å½“è¾¹ç•Œæ¡ä»¶æ»¡è¶³æ—¶ï¼Œé€’å½’è¿”å›ã€‚**

```js
// é€’å½’çš„ç»“æŸæ¡ä»¶ä¸ºiå¤§äº5
var i = 0;

function f1() {
  i++;
  if (i > 5) {
    return; // å‡ºå£
  }
  console.log(
    'ä»å‰æœ‰åº§å±±ï¼Œå±±é‡Œæœ‰åº§åº™ï¼Œåº™é‡Œæœ‰ä¸ªè€å’Œå°šå’Œä¸€ä¸ªå°å’Œå°šï¼Œæœ‰ä¸€å¤©è€å’Œå°šå¯¹å°å’Œå°šè®²æ•…äº‹ï¼Œæ•…äº‹å†…å®¹æ˜¯ï¼š'
  );
  f1();
}

f1();
```

### é€’å½’æ·±æ‹·è´ä»£ç 

```js
function deepCopy(obj) {
  // ç®€å•ç±»å‹ æˆ– null ç›´æ¥è¿”å›
  if (typeof obj !== 'object' || obj === null) {
    return obj;
  }
  const newObj = obj.constructor === Array ? [] : {};
  // å¾ªç¯ obj çš„å±æ€§/å…ƒç´ 
  for (const key in obj) {
    const val = obj[key];
    if (typeof val !== 'object' || val === null) {
      newObj[key] = val;
    } else {
      newObj[key] = deepCopy(val);
    }
  }
  return newObj;
}

var obj1 = {
  name: 'shen',
  show: function () {
    console.log('hello world');
  },
};
var obj2 = deepCopy(obj1);
console.log('obj1:', obj1); // obj1: { name: 'shen', show: [Function: show] }
console.log('obj2:', obj2); // obj2: { name: 'shen', show: [Function: show] }
```

# é—­åŒ…

## ä½œç”¨åŸŸ

**å˜é‡åˆ†ä¸ºå…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ã€‚ä½œç”¨åŸŸä¹Ÿå°±æ˜¯å˜é‡çš„ä½¿ç”¨èŒƒå›´ï¼Œåˆ†ä¸ºå…¨å±€ä½œç”¨åŸŸå’Œå±€éƒ¨ä½œç”¨åŸŸã€‚**

å±€éƒ¨å˜é‡çš„ä½¿ç”¨èŒƒå›´ä¸ºå±€éƒ¨ä½œç”¨åŸŸï¼Œå…¨å±€å˜é‡çš„ä½¿ç”¨èŒƒå›´æ˜¯å…¨å±€ä½œç”¨åŸŸã€‚

åœ¨ ES6 å¼•å…¥äº†`let`å®šä¹‰å˜é‡åï¼Œä¹Ÿå¢åŠ äº†ä¸€ä¸ª**å—çº§ä½œç”¨åŸŸ**ã€‚

## ä½œç”¨åŸŸé“¾

å†…éƒ¨å‡½æ•°è®¿é—®å¤–éƒ¨å‡½æ•°çš„å˜é‡æ—¶ï¼Œé‡‡ç”¨çš„æ˜¯é“¾å¼æŸ¥æ‰¾çš„æ–¹å¼ã€‚ä»é‡Œå‘å¤–æœç´¢ï¼Œå¦‚æœä¸­é—´æœåˆ°äº†å°±ä½¿ç”¨ï¼Œæœåˆ° 0 çº§ä½œç”¨åŸŸè¿˜æ²¡æœ‰æœåˆ°åˆ™æŠ¥é”™ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯**ä½œç”¨åŸŸé“¾**ã€‚

```js
// ä½œç”¨åŸŸé“¾:å˜é‡çš„ä½¿ç”¨,ä»é‡Œå‘å¤–,å±‚å±‚çš„æœç´¢,æœç´¢åˆ°äº†å°±ç›´æ¥ä½¿ç”¨
// æœç´¢åˆ°0çº§ä½œç”¨åŸŸçš„æ—¶å€™,å¦‚æœè¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªå˜é‡,å°±ä¼šæŠ¥é”™
const num1 = 10; //ä½œç”¨åŸŸé“¾
function f1() {
  const num2 = 20;
  function f2() {
    const num3 = 30;
    console.log(num1); // >10
  }
  f2();
}
f1();
```

![image-20210330160001771](assets/image-20210330160001771.png)

## é¢„è§£æ

JS ä»£ç åœ¨æµè§ˆå™¨ä¸­æ˜¯ç”± JS å¼•æ“è¿›è¡Œè§£ææ‰§è¡Œçš„ï¼Œåˆ†ä¸ºä¸¤æ­¥ï¼Œ**é¢„è§£æ**å’Œ**ä»£ç æ‰§è¡Œ**ã€‚

é¢„è§£æåˆ†ä¸º å˜é‡é¢„è§£æï¼ˆå˜é‡æå‡ï¼‰ å’Œ å‡½æ•°é¢„è§£æï¼ˆå‡½æ•°æå‡ï¼‰ï¼Œæµè§ˆå™¨ JS ä»£ç è¿è¡Œä¹‹å‰ï¼Œä¼šæŠŠå˜é‡çš„å£°æ˜å’Œå‡½æ•°çš„å£°æ˜æå‰(æå‡)åˆ°è¯¥ä½œç”¨åŸŸçš„æœ€ä¸Šé¢ã€‚

### å˜é‡é¢„è§£æ

æŠŠæ‰€æœ‰å˜é‡çš„å£°æ˜æå‡åˆ°å½“å‰ä½œç”¨åŸŸçš„æœ€å‰é¢ï¼Œä¸æå‡èµ‹å€¼æ“ä½œã€‚

ä¸‹é¢æ˜¯é¢„è§£æå‰ç¼–å†™çš„ä»£ç ã€‚

```js
// åŸå§‹ä»£ç 
console.log(num); // æ²¡æœ‰æŠ¥é”™ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªundefined
var num = 666;
```

é¢„è§£æåï¼Œnum å˜é‡å£°æ˜æå‡åˆ°æœ€å‰é¢ï¼Œä½†æ˜¯èµ‹å€¼æ“ä½œä»åœ¨åé¢ã€‚

```js
// é¢„è§£æåï¼šå˜é‡æå‡
var num;
console.log(num); // æ‰€ä»¥è¿”å›çš„æ˜¯ä¸€ä¸ªundefined
num = 666;
```

### å‡½æ•°é¢„è§£æ

å°†æ‰€æœ‰å‡½æ•°å£°æ˜æå‡åˆ°å½“å‰ä½œç”¨åŸŸçš„æœ€å‰é¢ã€‚

ä¸‹é¢æ˜¯é¢„è§£æå‰ç¼–å†™çš„ä»£ç ã€‚

```js
// åŸå§‹ä»£ç 
f1(); // èƒ½å¤Ÿæ­£å¸¸è°ƒç”¨
function f1() {
  console.log('Albertå”±æ­Œå¤ªå¥½å¬äº†');
}
```

é¢„è§£æåï¼Œå‡½æ•°å£°æ˜æå‡åˆ°æœ€å‰é¢ã€‚

```js
function f1() {
  console.log('Albertå”±æ­Œå¤ªå¥½å¬äº†');
}
f1(); //é¢„è§£æåï¼Œä»£ç æ˜¯é€è¡Œæ‰§è¡Œçš„ï¼Œæ‰§è¡Œåˆ° f1()åï¼Œå»è°ƒç”¨å‡½æ•° f1ï¼ˆï¼‰
```

## é—­åŒ…å®šä¹‰

å®˜æ–¹è¯´æ³•ï¼šJS çš„é—­åŒ…æ˜¯æŒ‡ä¸€ä¸ªå‡½æ•°ä¸å‘¨å›´çŠ¶æ€ï¼ˆè¯æ³•ç¯å¢ƒï¼‰çš„å¼•ç”¨æ†ç»‘åœ¨ä¸€èµ·ï¼ˆå°é—­ï¼‰çš„ç»„åˆï¼Œåœ¨ JS ä¸­ï¼Œæ¯æ¬¡åˆ›å»ºå‡½æ•°æ—¶ï¼Œéƒ½ä¼šåŒæ—¶åˆ›å»ºé—­åŒ…ã€‚é—­åŒ…æ˜¯ä¸€ç§ä¿æŠ¤ç§æœ‰å˜é‡çš„æœºåˆ¶ï¼Œåœ¨å‡½æ•°æ‰§è¡Œæ—¶å½¢æˆç§æœ‰çš„ä½œç”¨åŸŸï¼Œä¿æŠ¤é‡Œé¢çš„ç§æœ‰å˜é‡ä¸å—å¤–ç•Œå¹²æ‰°ï¼Œå³å½¢æˆä¸€ä¸ªä¸é”€æ¯çš„æ ˆç¯å¢ƒã€‚

é€šä¿—çš„å°†ï¼Œå°±æ˜¯**çˆ¶å‡½æ•°ä¸­åŒ…å«ä¸€ä¸ªå­å‡½æ•°ï¼Œå­å‡½æ•°å¯ä»¥è°ƒç”¨çˆ¶å‡½æ•°ä¸­çš„å˜é‡ã€‚**

- é—­åŒ…ç¤ºä¾‹ 1

```js
function parent() {
  let x = 0; // parent åˆ›å»ºå‡ºæ¥çš„å±€éƒ¨å˜é‡
  function children() {
    // children()æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªé—­åŒ…
    return ++x; // ä½¿ç”¨äº†çˆ¶å‡½æ•°ä¸­çš„å˜é‡
  }
  return children; // è¿”å›childrenå‡½æ•°
}
let children = parent(); // åˆ›å»ºchildrenå‡½æ•°
console.log(children()); // 1
console.log(children()); // 2
console.log(children()); // 3
console.log(children()); // 4
// åˆ›å»ºæ–°çš„childrenå‡½æ•°
children = parent();
console.log(children()); // 1
```

- é—­åŒ…ç¤ºä¾‹ 2

```js
// æ™®é€šçš„å‡½æ•°
function f1() {
  let num = 0;
  num++;
  return num;
}
// æ¯æ¬¡æ‰§è¡Œf1, numéƒ½æ˜¯é‡æ–°å®šä¹‰ï¼Œå¹¶ä¸”åˆå§‹åŒ–ä¸º0
console.log(f1()); // 1
console.log(f1()); // 1
console.log(f1()); // 1

// é—­åŒ…
function f2() {
  let num = 0;
  return function () {
    num++;
    return num;
  };
}
var ff = f2(); // ff = function() { num++; return num; }
// num æœ¬æ¥åœ¨ f2çš„ä½œç”¨åŸŸä¸­ï¼Œä½†æ˜¯ ff ä¹Ÿå¯ä»¥è°ƒç”¨ï¼Œç ´åäº† num çš„ä½œç”¨åŸŸã€‚
console.log(ff()); // 1
console.log(ff()); // 2
console.log(ff()); // 3
```

## é—­åŒ…çš„ä½œç”¨

é—­åŒ…å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸å°†å‡½æ•°ä¸å…¶æ‰€æ“ä½œçš„æŸäº›æ•°æ®ï¼ˆç¯å¢ƒï¼‰å…³è”èµ·æ¥ã€‚è¿™æ˜¾ç„¶ç±»ä¼¼äºé¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œå¯¹è±¡å…è®¸æˆ‘ä»¬å°†æŸäº›æ•°æ®ï¼ˆå¯¹è±¡çš„å±æ€§ï¼‰ä¸ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ–¹æ³•ç›¸å…³è”ã€‚

åœ¨ä¸€äº›ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæ¯”å¦‚ Javaï¼Œæ˜¯æ”¯æŒå°†æ–¹æ³•å£°æ˜ä¸ºç§æœ‰çš„(private)ï¼Œå³å®ƒä»¬åªèƒ½è¢«åŒä¸€ä¸ªç±»ä¸­çš„å…¶å®ƒæ–¹æ³•æ‰€è°ƒç”¨ã€‚è€Œ JavaScript æ²¡æœ‰è¿™ç§åŸç”Ÿæ”¯æŒï¼Œä½†æˆ‘ä»¬å¯ä»¥**ä½¿ç”¨é—­åŒ…æ¥æ¨¡æ‹Ÿç§æœ‰æ–¹æ³•**ã€‚

ç§æœ‰æ–¹æ³•ä¸ä»…ä»…æœ‰åˆ©äºé™åˆ¶å¯¹ä»£ç çš„è®¿é—®ï¼Œè¿˜æä¾›äº†ç®¡ç†å…¨å±€å‘½åç©ºé—´çš„å¼ºå¤§èƒ½åŠ›ï¼Œé¿å…éæ ¸å¿ƒçš„æ–¹æ³•å¼„ä¹±äº†ä»£ç çš„å…¬å…±æ¥å£éƒ¨åˆ†ã€‚

ä¸‹é¢æˆ‘ä»¬è®¡æ•°å™¨ä¸ºä¾‹ï¼Œä»£ç å¦‚ä¸‹ã€‚

```js
// é—­åŒ…çš„ä½œç”¨
var myCounter = function () {
  var privateCounter = 0;
  function changeBy(val) {
    privateCounter += val;
  }
  return {
    increment: function () {
      changeBy(1);
    },
    decrement: function () {
      changeBy(-1);
    },
    value: function () {
      return privateCounter;
    },
  };
};

var Counter1 = myCounter();
var Counter2 = myCounter();
console.log(Counter1.value()); /* è®¡æ•°å™¨1ç°åœ¨ä¸º 0 */
Counter1.increment();
Counter1.increment();
console.log(Counter1.value()); /* è®¡æ•°å™¨1ç°åœ¨ä¸º 2 */
Counter1.decrement();
console.log(Counter1.value()); /* è®¡æ•°å™¨1ç°åœ¨ä¸º 1 */

console.log(Counter2.value()); /* è®¡æ•°å™¨2ç°åœ¨ä¸º 0 */
Counter2.increment();
console.log(Counter2.value()); /* è®¡æ•°å™¨2ç°åœ¨ä¸º 1 */
```

åœ¨ä¸Šè¾¹çš„ä»£ç ä¸­æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå‡½æ•°å«ä¸¤ä¸ªç§æœ‰é¡¹ï¼šåä¸º privateCounter çš„å˜é‡å’Œåä¸º changeBy çš„å‡½æ•°ã€‚è¿™ä¸¤é¡¹éƒ½æ— æ³•åœ¨è¿™ä¸ªåŒ¿åå‡½æ•°å¤–éƒ¨ç›´æ¥è®¿é—®ã€‚å¿…é¡»é€šè¿‡åŒ¿åå‡½æ•°è¿”å›çš„ä¸‰ä¸ªå…¬å…±å‡½æ•°è®¿é—®ï¼ŒCounter.incrementï¼ŒCounter.decrement å’Œ Counter.valueï¼Œè¿™ä¸‰ä¸ªå…¬å…±å‡½æ•°å…±äº«åŒä¸€ä¸ªç¯å¢ƒçš„é—­åŒ…ï¼Œå¤šäº JavaScript çš„è¯æ³•ä½œç”¨åŸŸï¼Œå®ƒä»¬éƒ½å¯ä»¥è®¿é—® privateCounter å˜é‡å’Œ changeBy å‡½æ•°ã€‚

æˆ‘ä»¬æŠŠåŒ¿åå‡½æ•°å‚¨å­˜åœ¨ä¸€ä¸ªå˜é‡ myCounter ä¸­ï¼Œå¹¶ç”¨å®ƒæ¥åˆ›å»ºå¤šä¸ªè®¡æ•°å™¨ï¼Œæ¯æ¬¡åˆ›å»ºéƒ½ä¼šåŒæ—¶åˆ›å»ºé—­åŒ…ï¼Œå› ä¸ºæ¯ä¸ªé—­åŒ…éƒ½æœ‰å®ƒè‡ªå·±çš„è¯æ³•ç¯å¢ƒï¼Œæ¯ä¸ªé—­åŒ…éƒ½æ˜¯å¼•ç”¨è‡ªå·±è¯æ³•ä½œç”¨åŸŸå†…çš„å˜é‡ privateCounter ï¼Œæ‰€ä»¥ä¸¤ä¸ªè®¡æ•°å™¨ Counter1 å’Œ Counter2 æ˜¯å„è‡ªç‹¬ç«‹çš„ã€‚

ä»¥è¿™ç§æ–¹å¼ä½¿ç”¨é—­åŒ…ï¼Œæä¾›äº†è®¸å¤šä¸é¢å‘å¯¹è±¡ç¼–ç¨‹ç›¸å…³çš„å¥½å¤„ â€”â€” ç‰¹åˆ«æ˜¯**æ•°æ®éšè—å’Œå°è£…**ã€‚

## é—­åŒ…çš„å±å®³

é€šå¸¸æ¥è¯´ï¼Œå‡½æ•°çš„æ´»åŠ¨å¯¹è±¡ä¼šéšç€æ‰§è¡ŒæœŸä¸Šä¸‹æ–‡ä¸€èµ·é”€æ¯ï¼Œä½†æ˜¯ï¼Œç”±äºé—­åŒ…å¼•ç”¨å¦å¤–ä¸€ä¸ªå‡½æ•°çš„æ´»åŠ¨å¯¹è±¡ï¼Œå› æ­¤è¿™ä¸ªæ´»åŠ¨å¯¹è±¡æ— æ³•è¢«é”€æ¯ï¼Œè¿™æ„å‘³ç€ï¼Œé—­åŒ…æ¯”ä¸€èˆ¬çš„å‡½æ•°éœ€è¦**æ¶ˆè€—æ›´å¤šå†…å­˜**ã€‚

ä½¿ç”¨é—­åŒ…æ—¶ï¼Œä¼šæ¶‰åŠåˆ°**è·¨ä½œç”¨åŸŸè®¿é—®**ï¼Œæ¯æ¬¡è®¿é—®éƒ½ä¼šå¯¼è‡´**æ€§èƒ½æŸå¤±**ã€‚å› æ­¤åœ¨è„šæœ¬ä¸­ï¼Œæœ€å¥½å°å¿ƒä½¿ç”¨é—­åŒ…ï¼Œå®ƒåŒæ—¶ä¼šæ¶‰åŠåˆ°å†…å­˜å’Œé€Ÿåº¦é—®é¢˜ã€‚

ä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡æŠŠè·¨ä½œç”¨åŸŸå˜é‡å­˜å‚¨åœ¨å±€éƒ¨å˜é‡ä¸­ï¼Œç„¶åç›´æ¥è®¿é—®å±€éƒ¨å˜é‡ï¼Œæ¥å‡è½»å¯¹æ‰§è¡Œé€Ÿåº¦çš„å½±å“ã€‚

> [!note]
>
> å¦‚æœä¸æ˜¯æŸäº›ç‰¹å®šä»»åŠ¡éœ€è¦ä½¿ç”¨é—­åŒ…ï¼Œ**åœ¨å…¶å®ƒå‡½æ•°ä¸­åˆ›å»ºå‡½æ•°æ˜¯ä¸æ˜æ™ºçš„**ï¼Œå› ä¸ºé—­åŒ…åœ¨å¤„ç†é€Ÿåº¦å’Œå†…å­˜æ¶ˆè€—æ–¹é¢å¯¹è„šæœ¬æ€§èƒ½å…·æœ‰è´Ÿé¢å½±å“ã€‚
>
> ä¾‹å¦‚ï¼Œåœ¨åˆ›å»ºæ–°çš„å¯¹è±¡æˆ–è€…ç±»æ—¶ï¼Œæ–¹æ³•é€šå¸¸åº”è¯¥å…³è”äºå¯¹è±¡çš„åŸå‹ï¼Œè€Œä¸æ˜¯å®šä¹‰åˆ°å¯¹è±¡çš„æ„é€ å™¨ä¸­ã€‚åŸå› æ˜¯è¿™å°†å¯¼è‡´æ¯æ¬¡æ„é€ å™¨è¢«è°ƒç”¨æ—¶ï¼Œæ–¹æ³•éƒ½ä¼šè¢«é‡æ–°èµ‹å€¼ä¸€æ¬¡ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ¯ä¸ªå¯¹è±¡çš„åˆ›å»ºï¼Œæ–¹æ³•éƒ½ä¼šè¢«é‡æ–°èµ‹å€¼ï¼‰ã€‚
>
> ```js
> // âŒ ç”¨äº†é—­åŒ…ï¼Œä½†æ˜¾ç„¶æ²¡æœ‰å¥½å¤„
> function MyObject(name, message) {
>   this.name = name.toString();
>   this.message = message.toString();
>   this.getName = function () {
>     return this.name;
>   };
>
>   this.getMessage = function () {
>     return this.message;
>   };
> }
> ```
>
> ```js
> // âœ… æ”¹è¿›çš„æ–¹æ³•
> function MyObject(name, message) {
>   this.name = name.toString();
>   this.message = message.toString();
> }
> MyObject.prototype.getName = function () {
>   return this.name;
> };
> MyObject.prototype.getMessage = function () {
>   return this.message;
> };
> ```

# æ‰§è¡Œä¸Šä¸‹æ–‡

åœ¨ JavaScript ä¸­ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªåŸºæœ¬çš„æ¦‚å¿µï¼Œä½†å…¶ä¸­åˆåŒ…å«äº†å˜é‡å¯¹è±¡ã€ä½œç”¨åŸŸé“¾ã€this æŒ‡å‘ç­‰æ›´æ·±å…¥çš„å†…å®¹ï¼Œæ·±å…¥ç†è§£æ‰§è¡Œä¸Šä¸‹æ–‡ä»¥åŠå…¶ä¸­çš„å†…å®¹ï¼Œå¯¹æˆ‘ä»¬ä»¥åç†è§£ JavaScript ä¸­å…¶å®ƒæ›´æ·±å…¥çš„çŸ¥è¯†ç‚¹ï¼ˆå‡½æ•°/å˜é‡æå‡ã€é—­åŒ…ç­‰ï¼‰ä¼šæœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚

**æ‰§è¡Œä¸Šä¸‹æ–‡å¯ä»¥ç†è§£ä¸ºå½“å‰ä»£ç çš„è¿è¡Œç¯å¢ƒã€‚**åœ¨ JavaScript ä¸­ï¼Œè¿è¡Œç¯å¢ƒä¸»è¦åŒ…å«äº†**å…¨å±€ç¯å¢ƒ**å’Œ**å‡½æ•°ç¯å¢ƒ**ã€‚

åœ¨ JavaScript ä»£ç è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ€å…ˆè¿›å…¥çš„æ˜¯å…¨å±€ç¯å¢ƒï¼Œè€Œåœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶åˆ™è¿›å…¥ç›¸åº”çš„å‡½æ•°ç¯å¢ƒã€‚å…¨å±€ç¯å¢ƒå’Œå‡½æ•°ç¯å¢ƒæ‰€å¯¹åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡æˆ‘ä»¬åˆ†åˆ«ç§°ä¸º**å…¨å±€ä¸Šä¸‹æ–‡**å’Œ**å‡½æ•°ä¸Šä¸‹æ–‡**ã€‚

## æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ

åœ¨ä¸€ä¸ª JavaScript æ–‡ä»¶ä¸­ï¼Œç»å¸¸ä¼šæœ‰å¤šä¸ªå‡½æ•°è¢«è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ JavaScript ä»£ç è¿è¡Œè¿‡ç¨‹ä¸­å¾ˆå¯èƒ½ä¼šäº§ç”Ÿå¤šä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œé‚£ä¹ˆå¦‚ä½•å»ç®¡ç†è¿™å¤šä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡å‘¢ï¼Ÿ

æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯ä»¥æ ˆï¼ˆä¸€ç§ LIFO çš„æ•°æ®ç»“æ„ï¼‰çš„æ–¹å¼è¢«å­˜æ”¾èµ·æ¥çš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º**æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆï¼ˆExecution Context Stackï¼‰**ã€‚

**åœ¨ JavaScript ä»£ç å¼€å§‹æ‰§è¡Œæ—¶ï¼Œé¦–å…ˆè¿›å…¥å…¨å±€ç¯å¢ƒï¼Œæ­¤æ—¶å…¨å±€ä¸Šä¸‹æ–‡è¢«åˆ›å»ºå¹¶å…¥æ ˆï¼Œä¹‹åå½“è°ƒç”¨å‡½æ•°æ—¶åˆ™è¿›å…¥ç›¸åº”çš„å‡½æ•°ç¯å¢ƒï¼Œæ­¤æ—¶ç›¸åº”å‡½æ•°ä¸Šä¸‹æ–‡è¢«åˆ›å»ºå¹¶å…¥æ ˆï¼Œå½“å¤„äºæ ˆé¡¶çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä»£ç æ‰§è¡Œå®Œæ¯•åï¼Œåˆ™ä¼šå°†å…¶å‡ºæ ˆã€‚**

æ‰€ä»¥åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆä¸­ï¼Œæ ˆåº•æ°¸è¿œæ˜¯å…¨å±€ä¸Šä¸‹æ–‡ï¼Œè€Œæ ˆé¡¶åˆ™æ˜¯å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°ä¸Šä¸‹æ–‡ã€‚

æ–‡å­—è¡¨è¾¾æ—¢æ¯ç‡¥åˆéš¾ä»¥ç†è§£ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­å§ã€‚

```js
function fn2() {
  console.log('fn2');
}
function fn1() {
  console.log('fn1');
  fn2();
}
fn1();
```

è¿è¡Œä¸Šè¿°ä»£ç ï¼Œå¯ä»¥å¾—åˆ°ç›¸åº”çš„è¾“å‡ºï¼Œé‚£ä¹ˆä¸Šè¿°ä»£ç åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆçš„è¡Œä¸ºæ˜¯æ€æ ·çš„å‘¢ï¼Ÿ

```js
/* ä¼ªä»£ç  ä»¥æ•°ç»„æ¥è¡¨ç¤ºæ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ ECStack=[] */
// ä»£ç æ‰§è¡Œæ—¶æœ€å…ˆè¿›å…¥å…¨å±€ç¯å¢ƒï¼Œå…¨å±€ä¸Šä¸‹æ–‡è¢«åˆ›å»ºå¹¶å…¥æ ˆ
ECStack.push(global_EC);
// fn1 è¢«è°ƒç”¨ï¼Œfn1 å‡½æ•°ä¸Šä¸‹æ–‡è¢«åˆ›å»ºå¹¶å…¥æ ˆ
ECStack.push(fn1_EC);
// fn1 ä¸­è°ƒç”¨ fn2ï¼Œfn2 å‡½æ•°ä¸Šä¸‹æ–‡è¢«åˆ›å»ºå¹¶å…¥æ ˆ
ECStack.push(fn2_EC);
// fn2 æ‰§è¡Œå®Œæ¯•ï¼Œfn2 å‡½æ•°ä¸Šä¸‹æ–‡å‡ºæ ˆ
ECStack.pop();
// fn1 æ‰§è¡Œå®Œæ¯•ï¼Œfn1 å‡½æ•°ä¸Šä¸‹æ–‡å‡ºæ ˆ
ECStack.pop();
// ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå…¨å±€ä¸Šä¸‹æ–‡å‡ºæ ˆ
ECStack.pop();
```

æ‰§è¡Œçš„é¡ºåºå¯ä»¥ç”¨ä¸‹é¢çš„å›¾æ¥è¡¨ç¤ºã€‚

![image-20210404123420600](assets/image-20210404123420600.png?lastModify=1617511091)

## ä¸Šä¸‹æ–‡ç”Ÿå‘½å‘¨æœŸ

åœ¨ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ï¼Œæœ€é‡è¦çš„ä¸‰ä¸ªå±æ€§åˆ†åˆ«æ˜¯**å˜é‡å¯¹è±¡ï¼ˆVariable Objectï¼‰**ã€**ä½œç”¨åŸŸé“¾ï¼ˆScope Chainï¼‰**å’Œ **this æŒ‡å‘**ã€‚

ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡çš„ç”Ÿå‘½å‘¨æœŸåˆ†ä¸º**åˆ›å»º**å’Œ**æ‰§è¡Œ**é˜¶æ®µã€‚åˆ›å»ºé˜¶æ®µä¸»è¦å·¥ä½œæ˜¯**ç”Ÿæˆå˜é‡å¯¹è±¡**ã€**å»ºç«‹ä½œç”¨åŸŸé“¾**å’Œ**ç¡®å®š this æŒ‡å‘**ã€‚è€Œæ‰§è¡Œé˜¶æ®µä¸»è¦å·¥ä½œæ˜¯å˜é‡èµ‹å€¼ä»¥åŠæ‰§è¡Œå…¶å®ƒä»£ç ç­‰ã€‚

ä¸‹é¢ï¼Œæˆ‘ä»¬å°±æ¥çœ‹çœ‹åˆ›å»ºé˜¶æ®µå’Œæ‰§è¡Œé˜¶æ®µçš„ä¸åŒã€‚

- **åˆ›å»ºé˜¶æ®µ**ï¼šæ£€ç´¢å½“å‰ä¸Šä¸‹æ–‡çš„ä¼ å…¥å‚æ•°ã€å˜é‡å£°æ˜å’Œå‡½æ•°å£°æ˜ã€‚

- **æ‰§è¡Œé˜¶æ®µ**ï¼šèµ‹å€¼ã€æ‰§è¡Œå…¶ä»–ä»£ç ã€‚

> [!note]
>
> åˆ›å»ºä¸Šä¸‹æ–‡è¿‡ç¨‹ï¼Œåªå£°æ˜å˜é‡å’Œå‡½æ•°ï¼Œä¸å¯¹å…¶è¿›è¡Œèµ‹å€¼ï¼Œåªæœ‰åœ¨æ‰§è¡Œçš„æ—¶å€™æ‰è¿›è¡Œèµ‹å€¼ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä¹‹å‰è¯´è¿‡çš„**å˜é‡æå‡**å’Œ**å‡½æ•°æå‡**çš„å†…åœ¨æœºåˆ¶ã€‚

## ä¸Šä¸‹æ–‡ & ä½œç”¨åŸŸé“¾

äº†è§£äº†ä¸Šä¸‹æ–‡çŸ¥è¯†ï¼Œæˆ‘ä»¬å†æ¥å›é¡¾ä¸€ä¸‹ä½œç”¨åŸŸé“¾ã€‚

**ä½œç”¨åŸŸé“¾æ˜¯æŒ‡ç”±å½“å‰ä¸Šä¸‹æ–‡å’Œä¸Šå±‚ä¸Šä¸‹æ–‡çš„ä¸€ç³»åˆ—å˜é‡å¯¹è±¡ç»„æˆçš„å±‚çº§é“¾**ã€‚å®ƒä¿è¯äº†å½“å‰æ‰§è¡Œç¯å¢ƒå¯¹ç¬¦åˆè®¿é—®æƒé™çš„å˜é‡å’Œå‡½æ•°çš„æœ‰åºè®¿é—®ã€‚

æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œä¸Šä¸‹æ–‡åˆ†ä¸ºåˆ›å»ºå’Œæ‰§è¡Œä¸¤ä¸ªé˜¶æ®µï¼Œåœ¨æ‰§è¡Œé˜¶æ®µï¼Œå¦‚æœéœ€è¦ä½¿ç”¨æŸä¸ªå˜é‡ï¼Œé¦–å…ˆåœ¨å½“å‰ä¸Šä¸‹æ–‡æŸ¥æ‰¾ï¼Œ å¦‚æœæ‰¾ä¸åˆ°åˆ™å»ä¸‹ä¸€å±‚ä¸Šä¸‹æ–‡æŸ¥æ‰¾ï¼Œç›´è‡³æœ€åº•å±‚å…¨å±€ä¸Šä¸‹æ–‡æŸ¥æ‰¾ã€‚

![image-20210404125634397](assets/image-20210404125634397.png)

## ä¸Šä¸‹æ–‡ & this æŒ‡å‘

äº†è§£äº†ä¸Šä¸‹æ–‡çŸ¥è¯†ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ä¸Šä¸‹æ–‡ä¸ this æŒ‡å‘ä¹‹é—´çš„å…³ç³»ã€‚

**this çš„æŒ‡å‘ï¼Œæ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™ç¡®å®šçš„**ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸‹æ–‡è¢«åˆ›å»ºæ—¶ç¡®å®šçš„ã€‚

å…³äº this çš„æŒ‡å‘ï¼Œå…¶å®æœ€ä¸»è¦çš„æ˜¯ä¸‰ç§åœºæ™¯ï¼Œåˆ†åˆ«æ˜¯**å…¨å±€ä¸Šä¸‹æ–‡ä¸­ this**ã€**å‡½æ•°ä¸­ this** å’Œ**æ„é€ å‡½æ•°ä¸­ this**ã€‚

æˆ‘ä»¬å†æ¥æ€»ç»“ä¸€ä¸‹ï¼š

- å…¨å±€ä¸Šä¸‹æ–‡ä¸­çš„ thisï¼ŒæŒ‡å‘å…¨å±€å¯¹è±¡ windowã€‚
- å‡½æ•°ä¸­çš„ thisï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯ undefinedï¼Œéä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯ windowã€‚
- æ„é€ å‡½æ•°ä¸­çš„ thisï¼ŒæŒ‡å‘å®ä¾‹å¯¹è±¡ã€‚

## ä¸Šä¸‹æ–‡ & é—­åŒ…

åœ¨å„ä¸ªä¸Šä¸‹æ–‡å‡ºæ ˆåï¼Œå…¶å¯¹åº”çš„å˜é‡å¯¹è±¡ä¼šè¢« JavaScript ä¸­çš„è‡ªåŠ¨åƒåœ¾æ”¶é›†æœºåˆ¶å›æ”¶ã€‚

**è€Œæˆ‘ä»¬ç»å¸¸è¯´é—­åŒ…èƒ½å¤Ÿè®¿é—®å…¶æ‰€åœ¨ç¯å¢ƒçš„å˜é‡ï¼Œå…¶å®æ˜¯å› ä¸ºé—­åŒ…èƒ½å¤Ÿé˜»æ­¢ä¸Šè¿°å˜é‡å¯¹è±¡è¢«å›æ”¶çš„è¿‡ç¨‹ã€‚**

# å¼‚æ­¥ç¼–ç¨‹

JS æ˜¯å•çº¿ç¨‹çš„ï¼Œåœ¨æµè§ˆå™¨ä¸­ js çš„æ‰§è¡Œæ ˆè·Ÿæ¸²æŸ“çº¿ç¨‹æ˜¯ç›¸äº’é˜»å¡çš„ã€‚
å•çº¿ç¨‹æ¨¡å¼æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯æ›´å®‰å…¨ï¼Œæ›´ç®€å•
ç¼ºç‚¹ä¹Ÿå¾ˆæ˜ç¡®ï¼Œå°±æ˜¯å¦‚æœä¸­é—´æœ‰ä¸€ä¸ªç‰¹åˆ«è€—æ—¶çš„ä»»åŠ¡ï¼Œå…¶ä»–çš„ä»»åŠ¡å°±è¦ç­‰å¾…å¾ˆé•¿çš„æ—¶é—´ï¼Œå‡ºç°å‡æ­»çš„æƒ…å†µã€‚
ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼ŒJS æœ‰ä¸¤ç§ä»»åŠ¡çš„æ‰§è¡Œæ¨¡å¼ï¼šåŒæ­¥æ¨¡å¼ï¼ˆSynchronousï¼‰å’Œå¼‚æ­¥æ¨¡å¼ï¼ˆAsynchronousï¼‰ã€‚

## åŒæ­¥å’Œå¼‚æ­¥

**åŒæ­¥æ¨¡å¼ Synchronous**ç¨‹åºçš„æ‰§è¡Œé¡ºåºå’Œä»£ç çš„ç¼–å†™é¡ºåºæ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚ä»£ç æŒ‰é¡ºåºæ‰§è¡Œï¼Œåä¸€ä¸ªä»»åŠ¡å¿…é¡»ç­‰å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ‰èƒ½æ‰§è¡Œã€‚

ä¸€æ—¦æœ‰ä»»åŠ¡å¡ä½æˆ–æ‰§è¡Œè¾ƒæ…¢ï¼Œåˆ™åç»­æ‰€æœ‰ä»£ç éƒ½ä¼šå—åˆ°å½±å“ã€‚

**å¼‚æ­¥æ¨¡å¼ Asynchronous** ä¸ä¼šå»ç­‰å¾…è¿™ä¸ªä»»åŠ¡çš„ç»“æŸæ‰å¼€å§‹ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œéƒ½æ˜¯å¼€å¯è¿‡åå°±ç«‹å³å¾€åæ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚

**è€—æ—¶å‡½æ•°çš„åç»­é€»è¾‘ä¼šé€šè¿‡å›è°ƒå‡½æ•°çš„æ–¹å¼å®šä¹‰**ï¼Œä»»åŠ¡å®Œæˆåï¼Œå°±ä¼šè°ƒç”¨å›è°ƒå‡½æ•°ã€‚

## å›è°ƒå‡½æ•°å¼‚æ­¥æ–¹æ¡ˆ

å›è°ƒå‡½æ•°ç”±è°ƒç”¨è€…å®šä¹‰ï¼Œäº¤ç»™æ‰§è¡Œè€…æ‰§è¡Œçš„å‡½æ•°

```js
// callbackå°±æ˜¯å›è°ƒå‡½æ•°
// å°±æ˜¯æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œç¼ºç‚¹æ˜¯ä¸åˆ©äºé˜…è¯»ï¼Œæ‰§è¡Œé¡ºåºæ··ä¹±ã€‚
function foo(callback) {
  setTimeout(function () {
    callback();
  }, 3000);
}

foo(function () {
  console.log('è¿™å°±æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°');
  console.log('è°ƒç”¨è€…å®šä¹‰è¿™ä¸ªå‡½æ•°ï¼Œæ‰§è¡Œè€…æ‰§è¡Œè¿™ä¸ªå‡½æ•°');
  console.log('å…¶å®å°±æ˜¯è°ƒç”¨è€…å‘Šè¯‰æ‰§è¡Œè€…å¼‚æ­¥ä»»åŠ¡ç»“æŸååº”è¯¥åšä»€ä¹ˆ');
});
```

## Promise å¼‚æ­¥æ–¹æ¡ˆ

å›è°ƒçš„å¤šé‡åµŒå¥—ï¼Œä¼šå¯¼è‡´ä»£ç å¯è¯»ä½ã€ç¼–å†™è´¹åŠ²ã€å®¹æ˜“å‡ºé”™ï¼Œæ•…è€Œè¢«ç§°ä¸º **callback hell**ï¼ˆå›è°ƒåœ°ç‹±ï¼‰ã€‚
ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ã€‚CommonJS ç¤¾åŒºæå‡ºäº† Promise çš„è§„èŒƒï¼ŒES6 ä¸­ç§°ä¸ºè¯­è¨€è§„èŒƒã€‚

> [!note]
>
> **Promise å¹¶ä¸ç®—æ˜¯çœŸæ­£çš„å¼‚æ­¥ï¼Œåªä¸è¿‡æ˜¯å›è°ƒå‡½æ•°çš„è¯­æ³•ç³–å½¢å¼ã€‚**
>
> å›è°ƒå‡½æ•°æ˜¯æ¨ªå‘æ‹“å±•ï¼Œè€Œ Promise å°†å…¶è½¬æ¢æˆäº†ç«–å‘æ‹“å±•ã€‚

Promise æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥è¡¨è¿°ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œä¹‹åæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œå®ƒæœ‰å¤šä¸ªçŠ¶æ€ï¼š

- Pending å¾…å®šçŠ¶æ€, è¡¨ç¤ºè¿˜ä¸æ¸…æ¥šå¼‚æ­¥æ‰§è¡Œçš„ç»“æœ æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚
- Fulfilled å®ŒæˆçŠ¶æ€, è¡¨ç¤ºæ“ä½œå·²ç»å®Œæˆ
- Rejected æ“ä½œå¤±è´¥

![image-20210331104653972](assets/image-20210331104653972.png)

### Promise åŸºæœ¬ç”¨æ³•

```js
const promise = new Promise((resolve, reject) => {
  if (true) resolve(100);
  else reject(new Error('promise rejected'));
});

promise.then(
  (value) => {
    console.log('resolved', value); // 100
  },
  (error) => {
    console.log('rejected', error); // rejected Error: promise rejected
  }
);
```

### Promise é“¾å¼è°ƒç”¨

promise å¯¹è±¡ then æ–¹æ³•ï¼Œè¿”å›äº†å…¨æ–°çš„ promise å¯¹è±¡ã€‚å¯ä»¥å†ç»§ç»­è°ƒç”¨ then æ–¹æ³•ï¼Œå¦‚æœ return çš„ä¸æ˜¯ promise å¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼ä¼šä½œä¸º resolve çš„å€¼ä¼ é€’ï¼Œå¦‚æœæ²¡æœ‰å€¼ï¼Œé»˜è®¤æ˜¯ undefinedã€‚

**åé¢çš„ then æ–¹æ³•å°±æ˜¯åœ¨ä¸ºä¸Šä¸€ä¸ª then è¿”å›çš„ Promise æ³¨å†Œå›è°ƒã€‚**

**å‰é¢ then æ–¹æ³•ä¸­å›è°ƒå‡½æ•°çš„è¿”å›å€¼ä¼šä½œä¸ºåé¢ then æ–¹æ³•å›è°ƒçš„å‚æ•°ã€‚**

**å¦‚æœå›è°ƒä¸­è¿”å›çš„æ˜¯ Promiseï¼Œé‚£åé¢ then æ–¹æ³•çš„å›è°ƒä¼šç­‰å¾…å®ƒçš„ç»“æŸã€‚**

```js
// promiseå‡è®¾æ˜¯ä¸€ä¸ªPromiseå®ä¾‹
// thenä¸­çš„å›è°ƒreturnäº†ä¸€ä¸ªPromiseå®ä¾‹
promise
  .then(() => {
    return new Promise((resolve, reject) => {
      // some code
      resolve('å®å‚A');
    });
  })
  .then((æ¥æ”¶å®å‚A) => {
    // ä½œä¸ºä¸Šä¸€ä¸ªthenä¸­çš„å›è°ƒ;
  });

// thenä¸­å›è°ƒreturnçš„ä¸æ˜¯promiseå®ä¾‹
promise
  .then(() => {
    return 123;
  })
  .then((val) => {
    console.log(val); // 123
  });
```

### Promise å¼‚å¸¸å¤„ç†

catch å‡½æ•°æ¥æ•è·å¼‚å¸¸ã€‚

å¦‚æœ then ä¸­æ²¡æœ‰ä¼ å…¥ç¬¬äºŒä¸ªå›è°ƒ é‚£ä¹ˆå¼‚å¸¸ä¼šè¿›å…¥ catch çš„å›è°ƒå¤„ç†ã€‚

promise ä¸­å¦‚æœæœ‰å¼‚å¸¸ï¼Œéƒ½ä¼šè°ƒç”¨ reject æ–¹æ³•ï¼Œè¿˜å¯ä»¥ä½¿ç”¨.catch()ã€‚

ä½¿ç”¨.catch æ–¹æ³•æ›´ä¸ºå¸¸è§ï¼Œå› ä¸ºæ›´åŠ ç¬¦åˆé“¾å¼è°ƒç”¨ã€‚

```js
const promise = new Promise((resolve, rejcet) => {
  rejcet(new Error('Some Error.'));
});

promise
  .then(() => {
    console.log('success');
  })
  .catch((error) => {
    console.log(error); // Error: Some Error.
  });
```

### Promise å¹¶è¡Œæ‰§è¡Œ

- Promise.all()ï¼šå…¨éƒ¨æ‰§è¡Œç»“æŸåˆ™è¿”å›ã€‚

```js
const p1 = new Promise((resolve, rejcet) => {
  setTimeout(() => {
    console.log('1ç§’'); // 1ç§’åè¾“å‡º
    resolve(1);
  }, 1000);
});
const p2 = new Promise((resolve, rejcet) => {
  setTimeout(() => {
    console.log('2ç§’'); // 2ç§’åè¾“å‡º
    resolve(2);
  }, 2000);
});
const p3 = new Promise((resolve, rejcet) => {
  setTimeout(() => {
    console.log('3ç§’'); // 3ç§’åè¾“å‡º
    resolve(3);
  }, 3000);
});

Promise.all([p1, p2, p3]).then((values) => {
  console.log(values); // [1, 2, 3]
});
```

- Promise.race()ï¼šå…ˆç»“æŸçš„å°±ç›´æ¥è¿”å›ã€‚

```js
const p1 = new Promise((resolve, rejcet) => {
  setTimeout(() => {
    console.log('1ç§’'); // 1ç§’åè¾“å‡º
    resolve(1);
  }, 1000);
});
const p2 = new Promise((resolve, rejcet) => {
  setTimeout(() => {
    console.log('2ç§’'); // 2ç§’åè¾“å‡º
    resolve(2);
  }, 2000);
});
const p3 = new Promise((resolve, rejcet) => {
  setTimeout(() => {
    console.log('3ç§’'); // 3ç§’åè¾“å‡º
    resolve(3);
  }, 3000);
});

Promise.race([p1, p2, p3]).then((values) => {
  console.log(values); // p1æ‰§è¡Œç»“æŸåå°±è¾“å‡º 1
});
```

## Generator å¼‚æ­¥æ–¹æ¡ˆ

### Generator å‡½æ•°

Generator å‡½æ•°æ˜¯åç¨‹åœ¨ ES6 çš„å®ç°ï¼Œæœ€å¤§ç‰¹ç‚¹å°±æ˜¯å¯ä»¥äº¤å‡ºå‡½æ•°çš„æ‰§è¡Œæƒï¼ˆå³æš‚åœæ‰§è¡Œï¼‰ã€‚

```js
// Generator å‡½æ•°å®šä¹‰
function* gen(x) {
  let y = yield x + 2;
  yield 5;
  return y;
}
// Generator å‡½æ•°æ‰§è¡Œ
let g = gen(1); // å†…éƒ¨æŒ‡é’ˆï¼ˆéå†å™¨ï¼‰g
let res1 = g.next(); // è°ƒç”¨gçš„nextï¼Œå†…éƒ¨æ‰§è¡ŒçŸ¥é“é‡åˆ°yieldè¯­å¥
let res2 = g.next();
let res3 = g.next();
let res4 = g.next();
console.log('res1', res1);
console.log('res2', res2);
console.log('res3', res3);
console.log('res4', res3);

/** output
    res1 { value: 3, done: false }
    res2 { value: 5, done: false }
    res3 { value: undefined, done: true }
    res4 { value: undefined, done: true }
 */
```

ä¸Šé¢çš„å‡½æ•°å°±æ˜¯ä¸€ä¸ª Generator å‡½æ•°ï¼Œä»–ä¸åŒäºæ™®é€šå‡½æ•°ï¼Œä»–æ˜¯å¯ä»¥æš‚åœçš„ï¼Œæ‰€ä»¥ function åé¢åŠ \*å·ï¼Œä»¥ç¤ºåŒºåˆ«ã€‚

æ¯æ¬¡è°ƒç”¨ next æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰é˜¶æ®µçš„ä¿¡æ¯ï¼ˆ value å±æ€§å’Œ done å±æ€§ï¼‰ã€‚**value å±æ€§æ˜¯ yield è¯­å¥åé¢è¡¨è¾¾å¼çš„å€¼ï¼Œè¡¨ç¤ºå½“å‰é˜¶æ®µçš„å€¼ï¼›done å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤º Generator å‡½æ•°æ˜¯å¦æ‰§è¡Œå®Œæ¯•ï¼Œå³æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚**

æ•´ä¸ª Generator å‡½æ•°éƒ½æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„å®¹å™¨ï¼Œå®¹å™¨ä¸­éœ€è¦æš‚åœçš„åœ°æ–¹éƒ½æ˜¯ç”¨`yield`æ¥æ³¨æ˜ã€‚

### æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†

Generator å‡½æ•°å¯ä»¥æš‚åœæ‰§è¡Œå’Œæ¢å¤æ‰§è¡Œï¼Œè¿™æ˜¯å®ƒèƒ½å°è£…å¼‚æ­¥ä»»åŠ¡çš„æ ¹æœ¬åŸå› ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰ä¸¤ä¸ªç‰¹æ€§ï¼Œä½¿å®ƒå¯ä»¥ä½œä¸ºå¼‚æ­¥ç¼–ç¨‹çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼šå‡½æ•°ä½“å†…å¤–çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†æœºåˆ¶ã€‚

#### æ•°æ®äº¤æ¢

next æ–¹æ³•è¿”å›å€¼çš„ value å±æ€§ï¼Œæ˜¯ Generator å‡½æ•°å‘å¤–è¾“å‡ºæ•°æ®ï¼›next æ–¹æ³•è¿˜å¯ä»¥æ¥å—å‚æ•°ï¼Œè¿™æ˜¯å‘ Generator å‡½æ•°ä½“å†…è¾“å…¥æ•°æ®ã€‚

```js
function* gen(x) {
  var y = yield x + 2;
  return y;
}
var g = gen(1);
console.log(g.next());
console.log(g.next(6));

/** output
    { value: 3, done: false }
    { value: 6, done: true }
 */
```

ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ª next æ–¹æ³•çš„ value å±æ€§ï¼Œè¿”å›è¡¨è¾¾å¼ x + 2 çš„å€¼ï¼ˆ3ï¼‰ã€‚ç¬¬äºŒä¸ª next æ–¹æ³•å¸¦æœ‰å‚æ•° 2ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥ä¼ å…¥ Generator å‡½æ•°ï¼Œä½œä¸ºä¸Šä¸ªé˜¶æ®µå¼‚æ­¥ä»»åŠ¡çš„è¿”å›ç»“æœï¼Œè¢«å‡½æ•°ä½“å†…çš„å˜é‡ y æ¥æ”¶ã€‚å› æ­¤ï¼Œè¿™ä¸€æ­¥çš„ value å±æ€§ï¼Œè¿”å›çš„å°±æ˜¯ 6ï¼ˆå˜é‡ y çš„å€¼ï¼‰ã€‚

#### é”™è¯¯å¤„ç†

Generator å‡½æ•°å†…éƒ¨è¿˜å¯ä»¥éƒ¨ç½²é”™è¯¯å¤„ç†ä»£ç ï¼Œæ•è·å‡½æ•°ä½“å¤–æŠ›å‡ºçš„é”™è¯¯ã€‚

```js
function* gen(x) {
  try {
    var y = yield x + 2;
  } catch (e) {
    console.log(e);
  }
  return y;
}
var g = gen(1);
console.log(g.next());
console.log(g.throw('æŠ›å‡ºé”™è¯¯ï¼'));

/** output
    { value: 3, done: false }
    æŠ›å‡ºé”™è¯¯ï¼
    { value: undefined, done: true }
 */
```

ä¸Šé¢ä»£ç çš„æœ€åä¸€è¡Œï¼ŒGenerator å‡½æ•°ä½“å¤–ï¼Œä½¿ç”¨æŒ‡é’ˆå¯¹è±¡çš„ throw æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ï¼Œå¯ä»¥è¢«å‡½æ•°ä½“å†…çš„ try ... catch ä»£ç å—æ•è·ã€‚è¿™æ„å‘³ç€ï¼Œå‡ºé”™çš„ä»£ç ä¸å¤„ç†é”™è¯¯çš„ä»£ç ï¼Œå®ç°äº†æ—¶é—´å’Œç©ºé—´ä¸Šçš„åˆ†ç¦»ï¼Œè¿™å¯¹äºå¼‚æ­¥ç¼–ç¨‹æ— ç–‘æ˜¯å¾ˆé‡è¦çš„ã€‚

## async/await å¼‚æ­¥æ–¹æ¡ˆ

async/await æ˜¯ Generator å‡½æ•°çš„è¯­æ³•ç³–å½¢å¼ã€‚

**async**ä½œä¸ºä¸€ä¸ªå…³é”®å­—æ”¾åœ¨å‡½æ•°çš„å‰é¢ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œæ„å‘³ç€è¯¥å‡½æ•°çš„æ‰§è¡Œä¸ä¼šé˜»å¡åé¢ä»£ç çš„æ‰§è¡Œ å¼‚æ­¥å‡½æ•°çš„è°ƒç”¨è·Ÿæ™®é€šå‡½æ•°ä¸€æ ·ã€‚

**await**å°±æ˜¯ yeild çš„åŠŸèƒ½ï¼Œasync å‡½æ•°ä¸­çš„æš‚åœã€‚

async å‡½æ•°è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¦è·å– Promise çš„è¿”å›å€¼åº”è¯¥ç”¨ then æ–¹æ³•ã€‚

```js
async function timeout() {
  return 'hello world';
}
timeout().then((result) => {
  console.log(result);
});
console.log('æˆ‘åœ¨å¼‚æ­¥å‡½æ•°åé¢ï¼Œä¼šå…ˆæ‰§è¡Œè°å‘¢ï¼Ÿ');

/** output
    æˆ‘åœ¨å¼‚æ­¥å‡½æ•°åé¢ï¼Œä¼šå…ˆæ‰§è¡Œè°å‘¢ï¼Ÿ
    hello world
 */
```

æ­¤æ—¶å…ˆè¾“å‡ºçš„å°±æ˜¯åé¢çš„ä¸€ä¸²æ–‡å­—ï¼Œè¯´æ˜å¼‚æ­¥å‡½æ•°çš„æ‰§è¡Œæ²¡æœ‰é˜»å¡åé¢çš„ä»£ç æ‰§è¡Œï¼Œ`async`çš„å†…éƒ¨å®ç°åŸç†å°±æ˜¯å¦‚æœè¯¥å‡½æ•°ä¸­æœ‰ä¸€ä¸ªè¿”å›å€¼ï¼Œå½“è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œé»˜è®¤ä¼šåœ¨å†…éƒ¨è°ƒç”¨`Promise.solve()` æ–¹æ³•æŠŠå®ƒè½¬åŒ–æˆä¸€ä¸ª`Promise` å¯¹è±¡ä½œä¸ºè¿”å›ï¼Œè‹¥å‡½æ•°å†…éƒ¨æŠ›å‡ºé”™è¯¯ï¼Œåˆ™è°ƒç”¨`Promise.reject()`è¿”å›ä¸€ä¸ª`Promise` å¯¹è±¡ã€‚

# æ­£åˆ™è¡¨è¾¾å¼

æ­£åˆ™è¡¨è¾¾å¼åœ¨å„ç§ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œéƒ½æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚åœ¨ JavaScript ä¸­æ›´æ˜¯ä¸å¯æˆ–ç¼ºï¼Œæ­£åˆ™è¡¨è¾¾å¼é€šå¸¸è¢«ç”¨æ¥æ£€ç´¢ã€æ›¿æ¢é‚£äº›ç¬¦åˆæŸä¸ªæ¨¡å¼(è§„åˆ™)çš„æ–‡æœ¬ã€‚ä¾‹å¦‚éªŒè¯è¡¨å•ï¼šç”¨æˆ·åè¡¨å•åªèƒ½è¾“å…¥è‹±æ–‡å­—æ¯ã€æ•°å­—æˆ–è€…ä¸‹åˆ’çº¿ï¼Œ æ˜µç§°è¾“å…¥æ¡†ä¸­å¯ä»¥è¾“å…¥ä¸­æ–‡ã€‚

æ­¤å¤–ï¼Œæ­£åˆ™è¡¨è¾¾å¼è¿˜å¸¸ç”¨äºè¿‡æ»¤æ‰é¡µé¢å†…å®¹ä¸­çš„ä¸€äº›æ•æ„Ÿè¯(æ›¿æ¢)ï¼Œæˆ–ä»å­—ç¬¦ä¸²ä¸­è·å–æˆ‘ä»¬æƒ³è¦çš„ç‰¹å®šéƒ¨åˆ†(æå–)ç­‰ ã€‚ æœ¬æ–‡ä»æ­£åˆ™è¡¨è¾¾å¼çš„åŸºæœ¬æ¦‚å¿µå…¥æ‰‹ï¼Œè®²è§£äº†æ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹ç‚¹å’Œç»„æˆï¼Œå¹¶ä¸”è¯¦ç»†è®²è§£äº†æ­£åˆ™è¡¨è¾¾å¼åœ¨ JavaScript ä¸­çš„ä½¿ç”¨ï¼Œå¹¶ç»™å‡ºäº†ä¸€äº›åœ¨å®é™…å¼€å‘ä¸­ç»å¸¸ç”¨åˆ°çš„å®ä¾‹ã€‚

#### ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼

æ­£åˆ™è¡¨è¾¾å¼æ˜¯ç”¨äºåŒ¹é…è§„å¾‹è§„åˆ™çš„è¡¨è¾¾å¼ï¼Œå®ƒçš„â€œé¼»ç¥–â€å¯ä¸€ç›´è¿½æº¯åˆ°ç§‘å­¦å®¶å¯¹äººç±»ç¥ç»ç³»ç»Ÿçš„å·¥ä½œåŸç†çš„æ—©æœŸç ”ç©¶ã€‚ç°åœ¨åœ¨å„ç§ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼éƒ½æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚åœ¨ JavaScript ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ­£åˆ™è¡¨é€šå¸¸è¢«ç”¨æ¥æ£€ç´¢ã€æ›¿æ¢é‚£äº›ç¬¦åˆæŸä¸ªæ¨¡å¼(è§„åˆ™)çš„æ–‡æœ¬ã€‚
æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¯¹å­—ç¬¦ä¸²æ“ä½œçš„ä¸€ç§é€»è¾‘å…¬å¼ï¼Œå°±æ˜¯ç”¨äº‹å…ˆå®šä¹‰å¥½çš„ä¸€äº›ç‰¹å®šå­—ç¬¦ã€åŠè¿™äº›ç‰¹å®šå­—ç¬¦çš„ç»„åˆï¼Œç»„æˆä¸€ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ï¼Œè¿™ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ç”¨æ¥è¡¨è¾¾å¯¹å­—ç¬¦ä¸²çš„ä¸€ç§è¿‡æ»¤é€»è¾‘ã€‚

#### æ­£åˆ™è¡¨è¾¾å¼çš„ä½œç”¨

- ç»™å®šçš„å­—ç¬¦ä¸²æ˜¯å¦ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„è¿‡æ»¤é€»è¾‘(åŒ¹é…)ã€‚

- å¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»å­—ç¬¦ä¸²ä¸­è·å–æˆ‘ä»¬æƒ³è¦çš„ç‰¹å®šéƒ¨åˆ†(æå–)ã€‚

- å¼ºå¤§çš„å­—ç¬¦ä¸²æ›¿æ¢èƒ½åŠ›(æ›¿æ¢)ã€‚

#### æ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹ç‚¹

- çµæ´»æ€§ã€é€»è¾‘æ€§å’ŒåŠŸèƒ½æ€§éå¸¸çš„å¼º

- å¯ä»¥è¿…é€Ÿåœ°ç”¨æç®€å•çš„æ–¹å¼è¾¾åˆ°å­—ç¬¦ä¸²çš„å¤æ‚æ§åˆ¶

- å¯¹äºåˆšæ¥è§¦çš„äººæ¥è¯´ï¼Œæ¯”è¾ƒæ™¦æ¶©éš¾æ‡‚

#### æ­£åˆ™è¡¨è¾¾å¼çš„ç»„æˆ

- æ™®é€šå­—ç¬¦
- ç‰¹æ®Šå­—ç¬¦(å…ƒå­—ç¬¦)ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¸­æœ‰ç‰¹æ®Šæ„ä¹‰çš„å­—ç¬¦

ç¤ºä¾‹æ¼”ç¤ºï¼š

- `\d` åŒ¹é…æ•°å­—
- `ab\d` åŒ¹é… ab1ã€ab2

#### å…ƒå­—ç¬¦ä¸²

- å¸¸ç”¨å…ƒå­—ç¬¦ä¸²

| å…ƒå­—ç¬¦ | è¯´æ˜                           |
| :----- | :----------------------------- |
| \d     | åŒ¹é…æ•°å­—                       |
| \D     | åŒ¹é…ä»»æ„éæ•°å­—çš„å­—ç¬¦           |
| \w     | åŒ¹é…å­—æ¯æˆ–æ•°å­—æˆ–ä¸‹åˆ’çº¿         |
| \W     | åŒ¹é…ä»»æ„ä¸æ˜¯å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ |
| \s     | åŒ¹é…ä»»æ„çš„ç©ºç™½ç¬¦               |
| \S     | åŒ¹é…ä»»æ„ä¸æ˜¯ç©ºç™½ç¬¦çš„å­—ç¬¦       |
| .      | åŒ¹é…é™¤æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ |
| ^      | è¡¨ç¤ºåŒ¹é…è¡Œé¦–çš„æ–‡æœ¬(ä»¥è°å¼€å§‹)   |
| $      | è¡¨ç¤ºåŒ¹é…è¡Œå°¾çš„æ–‡æœ¬(ä»¥è°ç»“æŸ)   |

- é™å®šç¬¦

| é™å®šç¬¦ | è¯´æ˜              |
| :----- | :---------------- |
| \*     | é‡å¤é›¶æ¬¡æˆ–æ›´å¤šæ¬¡  |
| +      | é‡å¤ä¸€æ¬¡æˆ–æ›´å¤šæ¬¡  |
| ?      | é‡å¤é›¶æ¬¡æˆ–ä¸€æ¬¡    |
| {n}    | é‡å¤ n æ¬¡         |
| {n,}   | é‡å¤ n æ¬¡æˆ–æ›´å¤šæ¬¡ |
| {n,m}  | é‡å¤ n åˆ° m æ¬¡    |

- å…¶å®ƒç¬¦å·

| ç¬¦å·            | è¯´æ˜                                                                 |
| --------------- | -------------------------------------------------------------------- |
| \[\]            | å­—ç¬¦ä¸²ç”¨ä¸­æ‹¬å·æ‹¬èµ·æ¥ï¼Œè¡¨ç¤ºåŒ¹é…å…¶ä¸­çš„ä»»ä¸€å­—ç¬¦ã€‚                       |
| \[^\]           | åŒ¹é…ä¸­æ‹¬å·ä»¥å¤–çš„å†…å®¹ï¼Œç›¸å½“äºâ€**é**â€œçš„æ„æ€                           |
| \\              | è½¬ä¹‰ç¬¦                                                               |
| ã€¡              | é€‰æ‹©ä¸¤è€…ä¸­çš„ä¸€ä¸ªï¼Œç›¸å½“äºâ€**æˆ–è€…**â€œ                                   |
| \(\)            | ä»ä¸¤ä¸ªç›´æ¥é‡ä¸­é€‰æ‹©ä¸€ä¸ªï¼Œåˆ†ç»„ã€‚ ä¾‹å¦‚ï¼šgr(a ã€¡ e)y åŒ¹é… gray å’Œ greyã€‚ |
| [\u4e00-\u9fa5] | åŒ¹é…æ±‰å­—                                                             |

#### å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼

```js
// éªŒè¯æ‰‹æœºå·æ˜¯å¦11ä½
/^\d{11}$/
/^1[3-9]\d{9}$/
// éªŒè¯é‚®ç¼–
/^\d{6}$/
// éªŒè¯æ—¥æœŸ yyyy-mm-dd
/^\d{4}-\d{1,2}-\d{1,2}$/
// éªŒè¯é‚®ç®±
/^[0-9a-zA-Z_.-]+[@][0-9a-zA-Z_-]+([.][a-zA-Z]+){1,2}$/
// éªŒè¯IPåœ°å€ xxx.xxx.xxx.xxx
/^\d{1,3}\(.\d{1,3}){3}$/
// éªŒè¯ä¸­æ–‡
/^[\u4e00-\u9fa5]{2,6}$/
// éªŒè¯èº«ä»½è¯
/^[1-9]\d{5}(18|19|20|(3\d))\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/
```
